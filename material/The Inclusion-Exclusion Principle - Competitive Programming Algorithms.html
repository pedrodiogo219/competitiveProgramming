<!DOCTYPE html>
<!-- saved from url=(0064)https://cp-algorithms.com/combinatorics/inclusion-exclusion.html -->
<html class=" ya-page_js_yes"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!--<base href="https://cp-algorithms.com">--><base href=".">
    <title>The Inclusion-Exclusion Principle - Competitive Programming Algorithms</title>
    <script async="" src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/analytics.js"></script><script type="text/javascript" async="" charset="utf-8" src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/all.js"></script><script src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/jq.js"></script>
    <script src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/common.js"></script>
    <script type="text/x-mathjax-config;executed=true">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/MathJax.js">
    </script>
    <link rel="stylesheet" href="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/common.css">

    <!-- highlightjs for code highlighting -->
    <link rel="stylesheet" href="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/xcode.min.css">
    <script src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <!-- end highlightjs -->
    <meta name="google-site-verification" content="qSnbeMPNVgZ3kIpGVsPIAPIvEdwYSg583kPdwgJtFO8">
    <meta name="yandex-verification" content="f327630b02a1e115">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">#ya-site-form0,#ya-site-form0 .ya-site-form__form,#ya-site-form0 .ya-site-form__input,#ya-site-form0 .ya-site-form__input-text,#ya-site-form0 .ya-site-form__submit,#ya-site-form0 .ya-site-form__search-precise{font-size:12px!important;color:#000!important}#ya-site-form0 .ya-site-form__form-form{display:block}#ya-site-form0 .ya-site-form__form-form,#ya-site-form0 .ya-site-form__input,#ya-site-form0 .ya-site-form__search-precise,#ya-site-form0 .ya-site-form__search-precise__radio,#ya-site-form0 .ya-site-form__gap,#ya-site-form0 .ya-site-form__gap-i,#ya-site-form0 .ya-site-form__logo-img{margin:0;padding:0}#ya-site-form0{margin:0!important;padding:0!important}#ya-site-form0 .ya-site-form__logo-wrap{width:65px;vertical-align:top;border-collapse:collapse}#ya-site-form0 .ya-site-form__logo{display:block;width:52px;margin:0;padding:0 6px 0 0;text-decoration:none}#ya-site-form0 .ya-site-form__logo-img{width:52px;height:21px;border:0!important}#ya-site-form0 .ya-site-form__search-wrap{border-collapse:collapse}#ya-site-form0 .ya-site-form__search{font-size:12px!important;width:100%}#ya-site-form0 .ya-site-form__search-input,#ya-site-form0 .ya-site-form__search-precise,{border:0}#ya-site-form0 .ya-site-form__search-input{padding:6px}#ya-site-form0 .ya-site-form__search-input-layout,#ya-site-form0 .ya-site-form__search-input-layout-l,#ya-site-form0 .ya-site-form__search-input-layout-r{font-size:12px!important;padding:0;vertical-align:middle;border:0;border-collapse:collapse}#ya-site-form0 .ya-site-form__search-input-layout,#ya-site-form0 .ya-site-form__search-input-layout-l{width:100%}#ya-site-form0 .ya-site-form__search-precise{padding:0 18px 5px 6px;text-align:left;vertical-align:top}#ya-site-form0 .ya-site-form__search-precise-i{white-space:nowrap}#ya-site-form0 .ya-site-form__search-precise__radio{width:auto;margin:0 .3em 0 0;vertical-align:middle;background:none}#ya-site-form0 .ya-site-form__search-precise__label{margin:0 .4em 0 0;padding:0;vertical-align:middle}#ya-site-form0 .ya-site-form__input-text{width:100%;margin:0!important;cursor:text;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;background-color:#fff;border:1px solid #7f9db9;outline-style:none;-webkit-appearance:textfield}#ya-site-form0 .ya-site-form__input-text_type_hint{background-repeat:no-repeat;background-position:.2em 50%}#ya-site-form0 .ya-site-form__submit{display:block;width:auto;margin:0 0 0 5px}#ya-site-form0 .ya-site-form__arrow-wrap{overflow:hidden;width:30px;padding:0;vertical-align:middle}#ya-site-form0 .ya-site-form__arrow{position:relative}#ya-site-form0 .ya-site-form__arrow-a{position:absolute;top:50%;right:0;width:0;height:0;margin-top:-59px;border:solid transparent;border-width:59px 0 59px 30px;-moz-border-end-style:dotted}#ya-site-form0 .ya-site-form__wrap{width:100%;table-layout:fixed;border-collapse:collapse}#ya-site-form0 .ya-site-form__gap{border:0}#ya-site-form0 .ya-site-form__gap-i{width:9em}#ya-site-form0.ya-site-form_arrow_yes .ya-site-form__search-input{padding-right:0}#ya-site-form0.ya-site-form_logo_left .ya-site-form__logo{margin-top:4px;margin-left:5px}#ya-site-form0.ya-site-form_logo_top .ya-site-form__logo{display:block;margin:6px 0 0 6px}#ya-site-form0 .ya-site-form__submit_type_image{width:19px;height:15px;outline:none;cursor:pointer;border:0}#ya-site-form0 .ya-site-form__submit_type_image { background: url(https://site.yandex.net/v2.0/i/en/search.png) no-repeat }#ya-site-form0 .ya-site-form__input-text_type_hint { background-image:url(https://site.yandex.net/v2.0/i/en/yandex-hint-rb.png) }#ya-site-form0 .ya-site-form__form * { font-size: 12px !important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { font-style: normal!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { font-weight: normal!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { color: #000000!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { border-color: #7f9db9!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text:focus { border-color: #7f9db9!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { background-color: #ffffff!important }#ya-site-form0 .ya-site-form__search, #ya-site-form0 .ya-site-form__search td, #ya-site-form0 .yaform__precise-i { background-color: transparent !important }#ya-site-form0 .ya-site-form__search-precise__label { color:#000000 !important }#ya-site-form0 .ya-site-form__arrow-a { border-left-color: transparent }</style><style type="text/css">#ya-site-form0 .ya-site-suggest{position:relative;margin:0}#ya-site-form0 .ya-site-suggest-popup{position:absolute;width:100%}#ya-site-form0 .ya-site-suggest__opera-gap{position:absolute;height:25em;border:1px solid transparent}#ya-site-form0 .ya-site-suggest-list{position:absolute;z-index:9999;overflow:hidden;min-width:25em;width:100%;margin-top:-1px;border-collapse:separate;-webkit-box-shadow:0 1px 7px #9a9a9a;-moz-box-shadow:0 1px 7px #9a9a9a;box-shadow:0 1px 7px #9a9a9a;border:1px solid #dedede;border-color:rgba(154,154,154,0.5);border-top-color:rgba(154,154,154,0.4);border-bottom-color:rgba(154,154,154,0.6)}#ya-site-form0 .ya-site-suggest-list{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#ya-site-form0 .ya-site-suggest__iframe{position:absolute;z-index:-1;min-width:25em;width:100%;height:100%;background:#fff}#ya-site-form0 .ya-site-suggest-items{font-size:16px;min-width:25em;width:100%;margin:0;padding:0 1px 0 0;list-style:none}#ya-site-form0 .ya-site-suggest-items li{margin:0;padding:0;line-height:normal}#ya-site-form0 .ya-site-suggest-elem{display:block;padding:.25em .3em;cursor:pointer;background:url()}#ya-site-form0 a.ya-site-suggest-elem:link,#ya-site-form0 a.ya-site-suggest-elem:visited{text-decoration:none}html body #ya-site-form0 .ya-site-suggest-elem:link,html body #ya-site-form0 .ya-site-suggest-elem-link{color:#000!important}#ya-site-form0 .ya-site-suggest-elem:hover,html body #ya-site-form0 .ya-site-suggest-elem_state_hover{background:#fef6d7}#ya-site-form0 .ya-site-suggest-elem_nav:hover,#ya-site-form0 .ya-site-suggest-elem_translate:hover{text-decoration:none;color:#000!important}#ya-site-form0 .ya-site-suggest-elem_nav .ya-site-suggest__link{text-decoration:underline;color:#1a3dc1}#ya-site-form0 .ya-site-suggest-elem_translate .ya-site-suggest__link{text-decoration:underline;color:#000}#ya-site-form0 .ya-site-suggest-elem .ya-site-suggest__info{white-space:nowrap;color:#666}#ya-site-form0 .ya-site-suggest-elem_selected{background:#fdedaf}#ya-site-form0 .ya-site-suggest__fact{color:#555}#ya-site-form0 .ya-site-suggest__highlight{font-weight:bold}</style><link title="search e-maxx-eng" rel="search" type="application/opensearchdescription+xml" href="https://yandex.com/search/site/opensearch.xml?ShortName=search%20e-maxx-eng&amp;InputEncoding=utf-8&amp;Image=&amp;Url-results=https%3A%2F%2Fcp-algorithms.com%2Fsearch-results.html%3Fsearchid%3D2314495%26web%3D0%26text%3D%7BsearchTerms%7D&amp;Url-suggest=https%3A%2F%2Fsitesearch-suggest.yandex.ru%2Fv1%2Fsuggest%3F%26site%3D2314495%26lang%3Den%26part%3D%7BsearchTerms%7D&amp;Url-opensearchdescr=https%3A%2F%2Fyandex.com%2Fsearch%2Fsite%2Fopensearch.xml%3FShortName%3Dsearch%2520e-maxx-eng%26InputEncoding%3Dutf-8%26Image%3D%26Url-results%3Dhttps%253A%252F%252Fcp-algorithms.com%252Fsearch-results.html%253Fsearchid%253D2314495%2526web%253D0%2526text%253D%257BsearchTerms%257D%26Url-suggest%3Dhttps%253A%252F%252Fsitesearch-suggest.yandex.ru%252Fv1%252Fsuggest%253F%2526site%253D2314495%2526lang%253Den%2526part%253D%257BsearchTerms%257D"><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body data-v="2019-09-10:0/0 2019-09-09:0/0 2019-09-08:0/0 2019-09-07:0/0 2019-09-06:0/0 2019-09-05:0/0 2019-09-04:0/0" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<div id="container">
    <div id="navbar">
        <span id="title">
            <a href="https://cp-algorithms.com/">CP-Algorithms</a>
        </span>
        <span id="menu">
            <a href="https://github.com/e-maxx-eng/e-maxx-eng/commits/master/src/combinatorics/inclusion-exclusion.md" title="Changes History">Page Authors</a>
        </span>
        <span id="search" style="display:inline-block;width:200px;float:right;margin-top:7px;margin-right:20px;">
            <div class="ya-site-form ya-site-form_bg_transparent ya-site-form_logo_hint ya-site-form_inited_yes" id="ya-site-form0"><div class="ya-site-form__form"><table class="ya-site-form__wrap" cellpadding="0" cellspacing="0"><tbody><tr><td class="ya-site-form__search-wrap"><table class="ya-site-form__search" cellpadding="0" cellspacing="0"><tbody><tr><td class="ya-site-form__search-input"><table class="ya-site-form__search-input-layout"><tbody><tr><td class="ya-site-form__search-input-layout-l"><div class="ya-site-form__input"><input name="text" type="search" value="" class="ya-site-form__input-text ya-site-form__input-text_type_hint" autocomplete="off"><div class="ya-site-suggest"><div class="ya-site-suggest-popup" style="display: none;"><i class="ya-site-suggest__opera-gap"></i><div class="ya-site-suggest-list"><div class="ya-site-suggest__iframe"></div><ul class="ya-site-suggest-items"></ul></div></div></div></div></td><td class="ya-site-form__search-input-layout-r"><input class="ya-site-form__submit" type="button" value="Search"></td></tr></tbody></table></td></tr><tr><td class="ya-site-form__gap"><div class="ya-site-form__gap-i"></div></td></tr></tbody></table></td></tr></tbody></table></div></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
        </span>
    </div>
<h1>The Inclusion-Exclusion Principle</h1><div id="toc"><strong>Table of Contents</strong><br><div class="toc-H2"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-0">Statement</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-1">The verbal formula</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-2">The formulation in terms of sets</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-3">The formulation using Venn diagrams</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-4">The formulation in terms of probability theory</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-5">Proof</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-6">Generalization for calculating number of elements in exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.545em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.425em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.63em, 1000.42em, 2.414em, -999.997em); top: -2.227em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.233em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.07em; border-left: 0px solid; width: 0px; height: 0.739em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">r</script> sets</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-7">Usage when solving problems</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-8">A simple task on permutations</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-9">A simple task on (0, 1, 2) sequences</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-10">The number of integer solutions to the equation</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-11">The number of relative primes in a given interval</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-12">The number of integers in a given interval which are multiple of at least one of the given numbers</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-13">The number of strings that satisfy a given pattern</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-14">The number of ways of going from a cell to another</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-15">The number of coprime quadruples</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-16">The number of harmonic triplets</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-17">The number of permutations without fixed points (derangements)</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/combinatorics/inclusion-exclusion.html#toc-tgt-18">Practice Problems</a><a></a></div></div>

<p>The inclusion-exclusion principle is an important combinatorial way to compute the size of a set or the probability of complex events. It relates the sizes of individual sets with their union.</p>

<h2 id="toc-tgt-0">Statement</h2>

<h3 id="toc-tgt-1">The verbal formula</h3>

<p>The inclusion-exclusion principle can be expressed as follows:</p>

<p>To compute the size of a union of multiple sets, it is necessary to sum the sizes of these sets <strong>separately</strong>, and then subtract the sizes of all <strong>pairwise</strong> intersections of the sets, then add back the size of the intersections of <strong>triples</strong> of the sets, subtract the size of <strong>quadruples</strong> of the sets, and so on, up to the intersection of <strong>all</strong> sets.</p>

<h3 id="toc-tgt-2">The formulation in terms of sets</h3>

<p>The above definition can be expressed mathematically as follows:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 49.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 40.218em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1040.12em, 5.382em, -999.997em); top: -3.891em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mrow" id="MathJax-Span-6"><span class="mo" id="MathJax-Span-7" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8"><span class="munderover" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-17" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-20" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-22" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0.156em;"><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-27" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.515em;"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-30" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-31"><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="munderover" id="MathJax-Span-40" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 2.974em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.771em;"><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1002.97em, 4.408em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mn" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-51" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-52"><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-58" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-61"><span class="mrow" id="MathJax-Span-62"><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="munderover" id="MathJax-Span-65" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 3.896em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.232em;"><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1003.9em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mn" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-70" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-71" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-78" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-79"><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-81"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-83" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-85" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-89" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-92"><span class="mrow" id="MathJax-Span-93"><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-100" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-103"><span class="mrow" id="MathJax-Span-104"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-107" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-108"><span class="mrow" id="MathJax-Span-109"><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-113" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-117" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-120"><span class="mrow" id="MathJax-Span-121"><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.896em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.684em; border-left: 0px solid; width: 0px; height: 3.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munderover><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>≤</mo><mi>n</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi><mo>≤</mo><mi>n</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>1</mn></msub><mo>∩</mo><mo>⋯</mo><mo>∩</mo><msub><mi>A</mi><mi>n</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\left| \bigcup_{i=1}^n A_i \right| = \sum_{i=1}^n|A_i| - \sum_{1\leq i<j\leq n} |A_i \cap A_j| + \sum _{1\leq i<j<k\leq n}|A_i \cap A_j \cap A_k| - \cdots + (-1)^{n-1} | A_1 \cap \cdots \cap A_n |</script></p>

<p>And in a more compact way:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo&gt;&amp;#x2286;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-123" style="width: 20.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.396em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1016.29em, 5.484em, -999.997em); top: -3.891em; left: 0em;"><span class="mrow" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mo" id="MathJax-Span-126" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-127"><span class="munderover" id="MathJax-Span-128"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-130"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-139" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-141" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 5.177em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.847em;"><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1005.13em, 4.408em, -999.997em); top: -2.815em; left: 0em;"><span class="texatom" id="MathJax-Span-143"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Main;">∅</span><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-148" style="font-size: 70.7%; font-family: MathJax_Main;">⊆</span><span class="mo" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-150" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-154" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-157" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-160" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-163"><span class="mrow" id="MathJax-Span-164"><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="mo" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-168" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mo" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-174" style=""><span class="mrow" id="MathJax-Span-175"><span class="texatom" id="MathJax-Span-176" style=""><span class="mrow" id="MathJax-Span-177"><span class="mo" id="MathJax-Span-178" style="vertical-align: 1.488em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.79em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-179" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.408em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-184" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-186" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-188"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-191" style=""><span class="mrow" id="MathJax-Span-192"><span class="texatom" id="MathJax-Span-193" style=""><span class="mrow" id="MathJax-Span-194"><span class="mo" id="MathJax-Span-195" style="vertical-align: 1.488em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.79em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.896em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munderover><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">∅</mi><mo>≠</mo><mi>J</mi><mo>⊆</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo fence="false" stretchy="false">}</mo></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow></mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>∈</mo><mi>J</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\left|\bigcup_{i=1}^n A_i \right| = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}{\Biggl |}\bigcap_{j\in J}A_{j}{\Biggr |}</script></p>

<h3 id="toc-tgt-3">The formulation using Venn diagrams</h3>

<p>Let the diagram show three sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-196" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-197"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">A</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-199" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">B</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">C</script>:</p>

<p><img src="./The Inclusion-Exclusion Principle - Competitive Programming Algorithms_files/venn-inclusion-exclusion.png" alt="Venn diagram" title="Venn diagram"></p>

<p>Then the area of their union <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 5.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.46em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1004.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∪</mo><mi>B</mi><mo>∪</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">A \cup B \cup C</script> is equal to the sum of the areas <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">A</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-215" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-216"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">B</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-218" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-219"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">C</script> less double-covered areas <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" style="width: 3.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∩</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">A \cap B</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 3.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∩</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">A \cap C</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" style="width: 3.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mo>∩</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">B \cap C</script>, but with the addition of the area covered by three sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" style="width: 5.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.46em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1004.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-242" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>∩</mo><mi>B</mi><mo>∩</mo><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">A \cap B \cap C</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-243" style="width: 47.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 38.937em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1038.84em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-269" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">B</span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo>∪</mo><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo>−</mo><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo stretchy="false">)</mo><mo>−</mo><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo><mo>−</mo><mi>S</mi><mo stretchy="false">(</mo><mi>B</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo><mo>+</mo><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo>∩</mo><mi>B</mi><mo>∩</mo><mi>C</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">S(A \cup B \cup C) = S(A) + S(B) + S(C) - S(A \cap B) - S(A \cap C) - S(B \cap C) + S(A \cap B \cap C)</script></p>

<p>It can also be generalized for an association of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-298" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">n</script> sets.</p>

<h3 id="toc-tgt-4">The formulation in terms of probability theory</h3>

<p>If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-301" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-302"><span class="msubsup" id="MathJax-Span-303"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">A_i</script> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2...&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-306" style="width: 6.457em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.279em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1005.18em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-307"><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-311" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-313" style="font-family: MathJax_Main; padding-left: 0.156em;">2...</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2...</mn><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">(i = 1,2...n)</script> are events and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-316" style="width: 3.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.51em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-317"><span class="texatom" id="MathJax-Span-318"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-322"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-323" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-325" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">{\cal P}(A_i)</script> the probability of an event from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-326" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="msubsup" id="MathJax-Span-328"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">A_i</script> to occur, then the probability of their union (i.e. the probability that at least one of the events occur) is equal to:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 39.091em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.021em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-1.022em, 1031.77em, 4.972em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mtable" id="MathJax-Span-333" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 31.714em; height: 0px;"><span style="position: absolute; clip: rect(2.103em, 1004.61em, 6.714em, -999.997em); top: -5.325em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.869em; height: 0px;"><span style="position: absolute; clip: rect(2.103em, 1004.61em, 5.382em, -999.997em); top: -5.325em; right: 0em;"><span class="mtd" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="texatom" id="MathJax-Span-336"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mrow" id="MathJax-Span-339" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-340" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-341"><span class="munderover" id="MathJax-Span-342"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-350" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-353" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.845em, 1000em, 4.152em, -999.997em); top: -2.764em; right: 0em;"><span class="mtd" id="MathJax-Span-404"><span class="mrow" id="MathJax-Span-405"><span class="mtext" id="MathJax-Span-406" style="font-family: MathJax_Main;">&nbsp;</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.33em;"></span></span><span style="position: absolute; clip: rect(2.205em, 1000.98em, 5.535em, -999.997em); top: -4.045em; left: 4.869em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.486em, 1000.98em, 4.152em, -999.997em); top: -5.325em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-354"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356"></span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1000.72em, 4.255em, -999.997em); top: -2.764em; left: 50%; margin-left: -0.407em;"><span class="mtd" id="MathJax-Span-407"><span class="mrow" id="MathJax-Span-408"><span class="mi" id="MathJax-Span-409"></span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.05em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1025.46em, 9.275em, -999.997em); top: -6.504em; left: 6.15em;"><span style="display: inline-block; position: relative; width: 25.515em; height: 0px;"><span style="position: absolute; clip: rect(2.257em, 1014.65em, 5.484em, -999.997em); top: -5.325em; left: 0em;"><span class="mtd" id="MathJax-Span-358"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360"></span><span class="munderover" id="MathJax-Span-361" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0.156em;"><span class="texatom" id="MathJax-Span-363"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.515em;"><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-369" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-373"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-376" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-377" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-378" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="munderover" id="MathJax-Span-379" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 2.974em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.771em;"><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1002.97em, 4.408em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-381"><span class="mrow" id="MathJax-Span-382"><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-386" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-387" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-388" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-390" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-391"><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-393" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-394"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-398" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-400" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-402" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">+</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(2.871em, 1025.46em, 5.484em, -999.997em); top: -2.764em; left: 0em;"><span class="mtd" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413"></span><span class="munderover" id="MathJax-Span-414" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.896em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.232em;"><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1003.9em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mn" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-424" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-427" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-431"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-435" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-439" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-446" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-448" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-450" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-451"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-456"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-460"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-462" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-466" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.509em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.247em; border-left: 0px solid; width: 0px; height: 7.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mrow><mo>(</mo><mrow><munderover><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mo>−</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>≤</mo><mi>n</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mo>+</mo></mtd></mtr><mtr><mtd><mtext>&nbsp;</mtext></mtd><mtd><mi></mi><mo>+</mo></mtd><mtd><mi></mi><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>&lt;</mo><mi>j</mi><mo>&lt;</mo><mi>k</mi><mo>≤</mo><mi>n</mi></mrow></munder><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mn>1</mn></msub><mo>∩</mo><mo>⋯</mo><mo>∩</mo><msub><mi>A</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\begin{eqnarray}
{\cal P} \left( \bigcup_{i=1}^n A_i \right) &=& \sum_{i=1}^n{\cal P}(A_i)\ - \sum_{1\leq i<j\leq n} {\cal P}(A_i \cap A_j)\  + \\\
&+& \sum _{1\leq i<j<k\leq n}{\cal P}(A_i \cap A_j \cap A_k) - \cdots + (-1)^{n-1} {\cal P}( A_1 \cap \cdots \cap A_n )
\end{eqnarray}</script></p>

<p>And in a more compact way:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo&gt;&amp;#x2286;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-470" style="width: 24.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.443em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.103em, 1020.19em, 5.587em, -999.997em); top: -3.993em; left: 0em;"><span class="mrow" id="MathJax-Span-471"><span class="texatom" id="MathJax-Span-472"><span class="mrow" id="MathJax-Span-473"><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="mrow" id="MathJax-Span-475" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-476" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mrow" id="MathJax-Span-477"><span class="munderover" id="MathJax-Span-478"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-486" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-489" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span><span class="mo" id="MathJax-Span-490" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-491" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 5.177em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.847em;"><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1005.13em, 4.408em, -999.997em); top: -2.815em; left: 0em;"><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Main;">∅</span><span class="mo" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-498" style="font-size: 70.7%; font-family: MathJax_Main;">⊆</span><span class="mo" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-503" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-504" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-505" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-510" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-511"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-513"><span class="mrow" id="MathJax-Span-514"><span class="texatom" id="MathJax-Span-515"><span class="mrow" id="MathJax-Span-516"><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-519"><span class="mrow" id="MathJax-Span-520"><span class="mo" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mtext" id="MathJax-Span-524" style="font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="mi" id="MathJax-Span-527" style="font-family: MathJax_Caligraphic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span class="texatom" id="MathJax-Span-528" style=""><span class="mrow" id="MathJax-Span-529"><span class="texatom" id="MathJax-Span-530" style=""><span class="mrow" id="MathJax-Span-531"><span class="mo" id="MathJax-Span-532" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span></span></span></span></span><span class="munderover" id="MathJax-Span-533" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.408em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-535"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-538" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-539" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-540" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-545" style=""><span class="mrow" id="MathJax-Span-546"><span class="texatom" id="MathJax-Span-547" style=""><span class="mrow" id="MathJax-Span-548"><span class="mo" id="MathJax-Span-549" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 4.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mrow><mo>(</mo><mrow><munderover><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">∅</mi><mo>≠</mo><mi>J</mi><mo>⊆</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo fence="false" stretchy="false">}</mo></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">P</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.470em" minsize="2.470em">(</mo></mrow></mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>∈</mo><mi>J</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.470em" minsize="2.470em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">{\cal P} \left(\bigcup_{i=1}^n A_i \right) = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}\ {\cal P}{\Biggl (}\bigcap_{j\in J}A_{j}{\Biggr )}</script></p>

<h2 id="toc-tgt-5">Proof</h2>

<p>For the proof it is convenient to use the mathematical formulation in terms of set theory:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2205;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo&gt;&amp;#x2286;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.470em&quot; minsize=&quot;2.470em&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-550" style="width: 20.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.396em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1016.29em, 5.484em, -999.997em); top: -3.891em; left: 0em;"><span class="mrow" id="MathJax-Span-551"><span class="mrow" id="MathJax-Span-552"><span class="mo" id="MathJax-Span-553" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-554"><span class="munderover" id="MathJax-Span-555"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-557"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-563" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-566" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-568" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 5.177em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.847em;"><span class="mo" id="MathJax-Span-569" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1005.13em, 4.408em, -999.997em); top: -2.815em; left: 0em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Main;">∅</span><span class="mo" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">≠</span><span class="mi" id="MathJax-Span-574" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main;">⊆</span><span class="mo" id="MathJax-Span-576" style="font-size: 70.7%; font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mo" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-584" style="font-size: 70.7%; font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-587" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-588"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-589" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-590"><span class="mrow" id="MathJax-Span-591"><span class="texatom" id="MathJax-Span-592"><span class="mrow" id="MathJax-Span-593"><span class="mo" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="texatom" id="MathJax-Span-596"><span class="mrow" id="MathJax-Span-597"><span class="mo" id="MathJax-Span-598" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-601" style=""><span class="mrow" id="MathJax-Span-602"><span class="texatom" id="MathJax-Span-603" style=""><span class="mrow" id="MathJax-Span-604"><span class="mo" id="MathJax-Span-605" style="vertical-align: 1.488em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.79em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-606" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-607" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.408em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-608"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-611" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-612" style="font-size: 70.7%; font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-613" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="mi" id="MathJax-Span-617" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-618" style=""><span class="mrow" id="MathJax-Span-619"><span class="texatom" id="MathJax-Span-620" style=""><span class="mrow" id="MathJax-Span-621"><span class="mo" id="MathJax-Span-622" style="vertical-align: 1.488em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.79em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.896em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munderover><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>A</mi><mi>i</mi></msub></mrow><mo>|</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">∅</mi><mo>≠</mo><mi>J</mi><mo>⊆</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi><mo fence="false" stretchy="false">}</mo></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow></mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>∈</mo><mi>J</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.470em" minsize="2.470em">|</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">\left|\bigcup_{i=1}^n A_i \right| = \sum_{\emptyset \neq J\subseteq \{1,2,\ldots ,n\}} (-1)^{|J|-1}{\Biggl |}\bigcap_{j\in J}A_{j}{\Biggr |}</script></p>

<p>We want to prove that any element contained in at least one of the sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-623" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-624"><span class="msubsup" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-627" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">A_i</script> will occur in the formula only once (note that elements which are not present in any of the sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-628" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-629"><span class="msubsup" id="MathJax-Span-630"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-631" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-632" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">A_i</script> will never be considered on the right part of the formula).</p>

<p>Consider an element <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-633" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-634"><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">x</script> occurring in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-636" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.26em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main; padding-left: 0.259em;">≥</span><span class="mn" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>≥</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-27">k \geq 1</script> sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-641" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-642"><span class="msubsup" id="MathJax-Span-643"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">A_i</script>. We will show it is counted only once in the formula. Note that:</p>

<ul>
<li>in terms which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-646" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.97em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-647"><span class="texatom" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-652"><span class="mrow" id="MathJax-Span-653"><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-656" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-29">|J| = 1</script>, the item <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-657" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">x</script> will be counted <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-660" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.54em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-661"><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main;">+</span><span class="mtext" id="MathJax-Span-663" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-664" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mtext>&nbsp;</mtext><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">+\ k</script></strong> times;</li>
<li>in terms which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.97em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="texatom" id="MathJax-Span-667"><span class="mrow" id="MathJax-Span-668"><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mo" id="MathJax-Span-673" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.259em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-32">|J| = 2</script>, the item <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-676" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">x</script> will be counted <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-679" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.15em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-680"><span class="mo" id="MathJax-Span-681" style="font-family: MathJax_Main;">−</span><span class="mtext" id="MathJax-Span-682" style="font-family: MathJax_Main;">&nbsp;</span><span class="mrow" id="MathJax-Span-683"><span class="TeXmathchoice" id="MathJax-Span-684"><span class="texatom" id="MathJax-Span-685"><span class="mrow" id="MathJax-Span-686"><span class="mo" id="MathJax-Span-687" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-688"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-689" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.31em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.151em;"><span class="mn" id="MathJax-Span-690" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-691"><span class="texatom" id="MathJax-Span-692"><span class="mrow" id="MathJax-Span-693"><span class="mo" id="MathJax-Span-694" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mtext>&nbsp;</mtext><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-34">-\ \binom{k}{2}</script></strong> times - because it will be counted in those terms that include two of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-695" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-696"><span class="mi" id="MathJax-Span-697" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">k</script> sets containing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-698" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-699"><span class="mi" id="MathJax-Span-700" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">x</script>;</li>
<li>in terms which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-701" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.97em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-702"><span class="texatom" id="MathJax-Span-703"><span class="mrow" id="MathJax-Span-704"><span class="mo" id="MathJax-Span-705" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-706" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-707"><span class="mrow" id="MathJax-Span-708"><span class="mo" id="MathJax-Span-709" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-710" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-711" style="font-family: MathJax_Main; padding-left: 0.259em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-37">|J| = 3</script>, the item <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-712" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-713"><span class="mi" id="MathJax-Span-714" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">x</script> will be counted <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-715" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.15em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-716"><span class="mo" id="MathJax-Span-717" style="font-family: MathJax_Main;">+</span><span class="mtext" id="MathJax-Span-718" style="font-family: MathJax_Main;">&nbsp;</span><span class="mrow" id="MathJax-Span-719"><span class="TeXmathchoice" id="MathJax-Span-720"><span class="texatom" id="MathJax-Span-721"><span class="mrow" id="MathJax-Span-722"><span class="mo" id="MathJax-Span-723" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-724"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.31em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.151em;"><span class="mn" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-727"><span class="texatom" id="MathJax-Span-728"><span class="mrow" id="MathJax-Span-729"><span class="mo" id="MathJax-Span-730" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mtext>&nbsp;</mtext><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-39">+\ \binom{k}{3}</script></strong> times;</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-731" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.744em, 1001.08em, 2.154em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-732"><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">⋯</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: 0.191em; border-left: 0px solid; width: 0px; height: 0.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⋯</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">\cdots</script></li>
<li>in terms which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-734" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.02em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-735"><span class="texatom" id="MathJax-Span-736"><span class="mrow" id="MathJax-Span-737"><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-740"><span class="mrow" id="MathJax-Span-741"><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">|J| = k</script>, the item <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-745" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-746"><span class="mi" id="MathJax-Span-747" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">x</script> will be counted <strong><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-748" style="width: 6.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.382em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1005.23em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-749"><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-752" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-753"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-754" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="texatom" id="MathJax-Span-755"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-758" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-759" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-760" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-761" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-762"><span class="texatom" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"><span class="mo" id="MathJax-Span-765" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-768" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-769"><span class="texatom" id="MathJax-Span-770"><span class="mrow" id="MathJax-Span-771"><span class="mo" id="MathJax-Span-772" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-43">(-1)^{k-1}\cdot \binom{k}{k}</script></strong> times;</li>
<li>in terms which <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-773" style="width: 3.691em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.02em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-774"><span class="texatom" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"><span class="mo" id="MathJax-Span-777" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-778" style="font-family: MathJax_Math-italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-779"><span class="mrow" id="MathJax-Span-780"><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-782" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>J</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">|J| \gt k</script>, the item <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-784" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-785"><span class="mi" id="MathJax-Span-786" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">x</script> will be counted <strong>zero</strong> times;</li>
</ul>

<p>This leads us to the following sum of <a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">binomial coefficients</a>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-787" style="width: 35.966em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.46em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1029.26em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-788"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-790" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mrow" id="MathJax-Span-791" style="padding-left: 0.259em;"><span class="TeXmathchoice" id="MathJax-Span-792"><span class="texatom" id="MathJax-Span-793"><span class="mrow" id="MathJax-Span-794"><span class="mo" id="MathJax-Span-795" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-796"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-797" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-798" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-799"><span class="texatom" id="MathJax-Span-800"><span class="mrow" id="MathJax-Span-801"><span class="mo" id="MathJax-Span-802" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-803" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-804" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-805"><span class="texatom" id="MathJax-Span-806"><span class="mrow" id="MathJax-Span-807"><span class="mo" id="MathJax-Span-808" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-809"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-811" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-812"><span class="texatom" id="MathJax-Span-813"><span class="mrow" id="MathJax-Span-814"><span class="mo" id="MathJax-Span-815" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mrow" id="MathJax-Span-817" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-818"><span class="texatom" id="MathJax-Span-819"><span class="mrow" id="MathJax-Span-820"><span class="mo" id="MathJax-Span-821" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-822"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-824" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-825"><span class="texatom" id="MathJax-Span-826"><span class="mrow" id="MathJax-Span-827"><span class="mo" id="MathJax-Span-828" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-829" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-832" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-834" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-835"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mi" id="MathJax-Span-839" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-840" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-841" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-842" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-843" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-844"><span class="texatom" id="MathJax-Span-845"><span class="mrow" id="MathJax-Span-846"><span class="mo" id="MathJax-Span-847" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-848"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.31em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.151em;"><span class="mi" id="MathJax-Span-850" style="font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-851"><span class="texatom" id="MathJax-Span-852"><span class="mrow" id="MathJax-Span-853"><span class="mo" id="MathJax-Span-854" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-855" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-858" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-860" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 1.744em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-862" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-863"><span class="mrow" id="MathJax-Span-864"><span class="mi" id="MathJax-Span-865" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-866" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-867" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-869" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-870"><span class="texatom" id="MathJax-Span-871"><span class="mrow" id="MathJax-Span-872"><span class="mo" id="MathJax-Span-873" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-874"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-877"><span class="texatom" id="MathJax-Span-878"><span class="mrow" id="MathJax-Span-879"><span class="mo" id="MathJax-Span-880" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>+</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>−</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mi>i</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-46"> T = \binom{k}{1} - \binom{k}{2} + \binom{k}{3} - \cdots + (-1)^{i-1}\cdot \binom{k}{i} + \cdots + (-1)^{k-1}\cdot \binom{k}{k}</script></p>

<p>This expression is very similar to the binomial expansion of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-881" style="width: 4.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.49em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-882"><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-884" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-885" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-886" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">x</span><span class="msubsup" id="MathJax-Span-887"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mi" id="MathJax-Span-889" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-47">(1 - x)^k</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-890" style="width: 38.373em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.457em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1031.46em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-891"><span class="mo" id="MathJax-Span-892" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-893" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-894" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">x</span><span class="msubsup" id="MathJax-Span-896"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-897" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="mi" id="MathJax-Span-898" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-899" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mrow" id="MathJax-Span-900" style="padding-left: 0.259em;"><span class="TeXmathchoice" id="MathJax-Span-901"><span class="texatom" id="MathJax-Span-902"><span class="mrow" id="MathJax-Span-903"><span class="mo" id="MathJax-Span-904" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-905"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-906" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-907" style="font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-908"><span class="texatom" id="MathJax-Span-909"><span class="mrow" id="MathJax-Span-910"><span class="mo" id="MathJax-Span-911" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-912" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-913" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-914"><span class="texatom" id="MathJax-Span-915"><span class="mrow" id="MathJax-Span-916"><span class="mo" id="MathJax-Span-917" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-918"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-920" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-921"><span class="texatom" id="MathJax-Span-922"><span class="mrow" id="MathJax-Span-923"><span class="mo" id="MathJax-Span-924" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-925" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-926" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">x</span><span class="mo" id="MathJax-Span-927" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mrow" id="MathJax-Span-928" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-929"><span class="texatom" id="MathJax-Span-930"><span class="mrow" id="MathJax-Span-931"><span class="mo" id="MathJax-Span-932" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-933"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-934" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-935" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-936"><span class="texatom" id="MathJax-Span-937"><span class="mrow" id="MathJax-Span-938"><span class="mo" id="MathJax-Span-939" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="msubsup" id="MathJax-Span-941" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-942" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.566em;"><span class="mn" id="MathJax-Span-943" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-945" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-946"><span class="texatom" id="MathJax-Span-947"><span class="mrow" id="MathJax-Span-948"><span class="mo" id="MathJax-Span-949" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-950"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-952" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-953"><span class="texatom" id="MathJax-Span-954"><span class="mrow" id="MathJax-Span-955"><span class="mo" id="MathJax-Span-956" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-957" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="msubsup" id="MathJax-Span-958" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.566em;"><span class="mn" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-962" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-963" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-965" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-966" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-967"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="mi" id="MathJax-Span-969" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-970" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-971" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-972"><span class="texatom" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mo" id="MathJax-Span-975" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-976"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-977" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-979"><span class="texatom" id="MathJax-Span-980"><span class="mrow" id="MathJax-Span-981"><span class="mo" id="MathJax-Span-982" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="msubsup" id="MathJax-Span-984" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-985" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.566em;"><span class="mi" id="MathJax-Span-986" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>0</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mi>x</mi><mo>+</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><msup><mi>x</mi><mi>k</mi></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48"> (1 - x)^k = \binom{k}{0} - \binom{k}{1} \cdot x + \binom{k}{2} \cdot x^2 - \binom{k}{3} \cdot x^3 + \cdots + (-1)^k\cdot \binom{k}{k} \cdot x^k </script></p>

<p>When <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-987" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-988"><span class="mi" id="MathJax-Span-989" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-990" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-991" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-49">x = 1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-992" style="width: 4.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.49em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-993"><span class="mo" id="MathJax-Span-994" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-995" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-997" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">x</span><span class="msubsup" id="MathJax-Span-998"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-999" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mi" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-50">(1 - x)^k</script> looks a lot like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1001" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.67em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1002"><span class="mi" id="MathJax-Span-1003" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">T</script>. However, the expression has an additional <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1004" style="width: 3.794em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1003.02em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-1005"><span class="mrow" id="MathJax-Span-1006"><span class="TeXmathchoice" id="MathJax-Span-1007"><span class="texatom" id="MathJax-Span-1008"><span class="mrow" id="MathJax-Span-1009"><span class="mo" id="MathJax-Span-1010" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1011"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-1012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.31em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.151em;"><span class="mn" id="MathJax-Span-1013" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1014"><span class="texatom" id="MathJax-Span-1015"><span class="mrow" id="MathJax-Span-1016"><span class="mo" id="MathJax-Span-1017" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-1018" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1019" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>k</mi><mn>0</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-52">\binom{k}{0} = 1</script>, and it is multiplied by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1020" style="width: 1.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.23em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1021"><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1023" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-53">-1</script>. That leads us to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1024" style="width: 8.66em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.072em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1007.07em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1025"><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1027" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-1029" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="msubsup" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mi" id="MathJax-Span-1032" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1033" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1034" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-1035" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>=</mo><mn>1</mn><mo>−</mo><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">(1 - 1)^k = 1 - T</script>. Therefore <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1037" style="width: 10.812em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.865em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1008.81em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1038"><span class="mi" id="MathJax-Span-1039" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-1040" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1041" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-1042" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mn" id="MathJax-Span-1044" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1045" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-1046" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="msubsup" id="MathJax-Span-1047"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mi" id="MathJax-Span-1049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1050" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1051" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi><mo>=</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-55">T = 1 - (1 - 1)^k = 1</script>, what was required to prove. The element is counted only once.</p>

<h2 id="toc-tgt-6">Generalization for calculating number of elements in exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1052" style="width: 0.548em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.446em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.607em, 1000.41em, 2.256em, -999.998em); top: -2.15em; left: 0em;"><span class="mrow" id="MathJax-Span-1053"><span class="mi" id="MathJax-Span-1054" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.153em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.04em; border-left: 0px solid; width: 0px; height: 0.627em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">r</script> sets</h2>

<p>Inclusion-exclusion principle can be rewritten to calculate number of elements which are present in zero sets:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo accent=&quot;false&quot;&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msup&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1055" style="width: 17.062em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.988em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1013.89em, 5.535em, -999.997em); top: -3.942em; left: 0em;"><span class="mrow" id="MathJax-Span-1056"><span class="mrow" id="MathJax-Span-1057"><span class="mo" id="MathJax-Span-1058" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1059"><span class="munderover" id="MathJax-Span-1060"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-1061" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.08em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1062"><span class="mrow" id="MathJax-Span-1063"><span class="mi" id="MathJax-Span-1064" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1065" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1066" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.361em;"><span class="mi" id="MathJax-Span-1067" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1068" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.08em, 4.306em, -999.997em); top: -3.993em; left: 0.003em;"><span class="msubsup" id="MathJax-Span-1069"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1070" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.08em, 3.742em, -999.997em); top: -4.506em; left: 0em;"><span class="mo" id="MathJax-Span-1072" style=""><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; top: -3.993em; left: -0.049em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.771em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.156em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.361em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.566em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1073" style="vertical-align: 1.693em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.329em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.303em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1074" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-1075" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-1076" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.49em, 4.255em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1077"><span class="mrow" id="MathJax-Span-1078"><span class="mi" id="MathJax-Span-1079" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1080" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1081" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.566em;"><span class="mi" id="MathJax-Span-1082" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1083" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1084" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1085" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1086"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1087" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="mi" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1089" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.361em;"><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.15em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-1091"><span class="mrow" id="MathJax-Span-1092"><span class="texatom" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mo" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1096" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1097"><span class="mrow" id="MathJax-Span-1098"><span class="mo" id="MathJax-Span-1099" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1100" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1102" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-1103" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1104"><span class="munderover" id="MathJax-Span-1105"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-1106" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.34em, 4.306em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1107"><span class="mrow" id="MathJax-Span-1108"><span class="mi" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1110" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1112" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1113" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mi" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1117" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.947em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munderover><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mover><msub><mi>A</mi><mi>i</mi></msub><mo accent="false">¯</mo></mover></mrow><mo>|</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>m</mi></msup><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>m</mi></mrow></munder><mrow><mo>|</mo><mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mi>X</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-57">\left|\bigcap_{i=1}^n \overline{A_i}\right|=\sum_{m=0}^n (-1)^m \sum_{|X|=m} \left|\bigcap_{i\in X} A_{i}\right|</script></p>

<p>Consider its generalization to calculate number of elements which are present in exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1118" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1119"><span class="mi" id="MathJax-Span-1120" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">r</script> sets:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C3;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2209;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo accent=&quot;false&quot;&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1121" style="width: 29.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.029em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(3.025em, 1023.93em, 6.714em, -999.997em); top: -5.12em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mrow" id="MathJax-Span-1123"><span class="mo" id="MathJax-Span-1124" style="vertical-align: 1.949em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -0.92em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.456em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.688em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1125"><span class="munderover" id="MathJax-Span-1126"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.361em;"><span class="mo" id="MathJax-Span-1127" style="font-family: MathJax_Size2; vertical-align: 0em;">⋃</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.8em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-1128"><span class="mrow" id="MathJax-Span-1129"><span class="texatom" id="MathJax-Span-1130"><span class="mrow" id="MathJax-Span-1131"><span class="mo" id="MathJax-Span-1132" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="texatom" id="MathJax-Span-1134"><span class="mrow" id="MathJax-Span-1135"><span class="mo" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1137" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1139" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-1140" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mrow" id="MathJax-Span-1141"><span class="munderover" id="MathJax-Span-1142"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-1143" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.306em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1144"><span class="mrow" id="MathJax-Span-1145"><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1147" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1149" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1150" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1152" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="munderover" id="MathJax-Span-1153" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-1154" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.28em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-1155"><span class="mrow" id="MathJax-Span-1156"><span class="mi" id="MathJax-Span-1157" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1158" style="font-size: 70.7%; font-family: MathJax_Main;">∉</span><span class="mi" id="MathJax-Span-1159" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1160" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.13em, 4.46em, -999.997em); top: -3.993em; left: 0.003em;"><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.13em, 3.742em, -999.997em); top: -4.506em; left: 0em;"><span class="mo" id="MathJax-Span-1164" style=""><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; top: -3.993em; left: -0.049em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.822em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.105em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.31em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.464em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.669em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1165" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span class="mo" id="MathJax-Span-1166" style="vertical-align: 1.949em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -0.92em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.456em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.688em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1167" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-1168" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1001.49em, 4.255em, -999.997em); top: -2.969em; left: 0em;"><span class="texatom" id="MathJax-Span-1170"><span class="mrow" id="MathJax-Span-1171"><span class="mi" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.515em;"><span class="mi" id="MathJax-Span-1175" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1176" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1177" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1178" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1179"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-1181"><span class="mrow" id="MathJax-Span-1182"><span class="mi" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mstyle" id="MathJax-Span-1186"><span class="mrow" id="MathJax-Span-1187"><span class="mrow" id="MathJax-Span-1188"><span class="TeXmathchoice" id="MathJax-Span-1189"><span class="texatom" id="MathJax-Span-1190"><span class="mrow" id="MathJax-Span-1191"><span class="mo" id="MathJax-Span-1192" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1193"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.87em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.459em;"><span class="mi" id="MathJax-Span-1194" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1196"><span class="texatom" id="MathJax-Span-1197"><span class="mrow" id="MathJax-Span-1198"><span class="mo" id="MathJax-Span-1199" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span></span><span class="munderover" id="MathJax-Span-1200" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.361em;"><span class="mo" id="MathJax-Span-1201" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.15em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-1202"><span class="mrow" id="MathJax-Span-1203"><span class="texatom" id="MathJax-Span-1204"><span class="mrow" id="MathJax-Span-1205"><span class="mo" id="MathJax-Span-1206" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1208"><span class="mrow" id="MathJax-Span-1209"><span class="mo" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1212" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1213" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-1214" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1215"><span class="munderover" id="MathJax-Span-1216"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.34em, 4.306em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1218"><span class="mrow" id="MathJax-Span-1219"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1221" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1223" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1224" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-1225"><span class="mrow" id="MathJax-Span-1226"><span class="mi" id="MathJax-Span-1227" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1228" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.126em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 4.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munder><mo>⋃</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>r</mi></mrow></munder><mrow><mo>[</mo><mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mi>B</mi></mrow></munder><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>∉</mo><mi>B</mi></mrow></munder><mover><msub><mi>A</mi><mi>j</mi></msub><mo accent="false">¯</mo></mover></mrow><mo>]</mo></mrow></mrow><mo>|</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>=</mo><mi>r</mi></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mi>r</mi></mrow></msup><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>m</mi><mi>r</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></mstyle><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>m</mi></mrow></munder><mrow><mo>|</mo><mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mi>X</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-59">\left|\bigcup_{|B|=r}\left[\bigcap_{i \in B} A_i \cap \bigcap_{j \not\in B} \overline{A_j}\right]\right|=\sum_{m=r}^n (-1)^{m-r}\dbinom{m}{r} \sum_{|X|=m} \left|\bigcap_{i \in X} A_{i}\right|</script></p>

<p>To prove this formula, consider some particular <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1229" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1230"><span class="mi" id="MathJax-Span-1231" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">B</script>. Due to basic inclusion-exclusion principle we can say about it that:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2209;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo accent=&quot;false&quot;&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mstyle scriptlevel=&quot;1&quot;&gt;&lt;mtable rowspacing=&quot;0.1em&quot; columnspacing=&quot;0em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;&amp;#x2282;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mstyle&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x22C2;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1232" style="width: 23.056em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.906em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.052em, 1018.8em, 6.304em, -999.997em); top: -4.096em; left: 0em;"><span class="mrow" id="MathJax-Span-1233"><span class="mrow" id="MathJax-Span-1234"><span class="mo" id="MathJax-Span-1235" style="vertical-align: 1.898em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -0.971em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.739em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1236"><span class="munderover" id="MathJax-Span-1237"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.054em;"><span class="mo" id="MathJax-Span-1238" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.23em, 4.306em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1239"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1242" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1243" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1244" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1247" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="munderover" id="MathJax-Span-1248" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-1249" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.28em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-1250"><span class="mrow" id="MathJax-Span-1251"><span class="mi" id="MathJax-Span-1252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1253" style="font-size: 70.7%; font-family: MathJax_Main;">∉</span><span class="mi" id="MathJax-Span-1254" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1255" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1001.13em, 4.46em, -999.997em); top: -3.993em; left: 0.003em;"><span class="msubsup" id="MathJax-Span-1256"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1257" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.13em, 3.742em, -999.997em); top: -4.506em; left: 0em;"><span class="mo" id="MathJax-Span-1259" style=""><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; top: -3.993em; left: -0.049em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.822em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.105em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.31em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.464em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.993em; left: 0.669em;"><span style="font-size: 70.7%; font-family: MathJax_Main;">¯</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1260" style="vertical-align: 1.898em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -0.971em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.508em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.739em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1261" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-1262" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.003em;"><span class="mo" id="MathJax-Span-1263" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1001.49em, 4.255em, -999.997em); top: -2.969em; left: 0em;"><span class="texatom" id="MathJax-Span-1264"><span class="mrow" id="MathJax-Span-1265"><span class="mi" id="MathJax-Span-1266" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1267" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.41em, 4.152em, -999.997em); top: -5.12em; left: 0.515em;"><span class="texatom" id="MathJax-Span-1269"><span class="mrow" id="MathJax-Span-1270"><span class="mi" id="MathJax-Span-1271" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1272" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1274" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1275"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1276" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-1277"><span class="mrow" id="MathJax-Span-1278"><span class="mi" id="MathJax-Span-1279" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1280" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-1282" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.515em;"><span class="mo" id="MathJax-Span-1283" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1002.31em, 4.716em, -999.997em); top: -2.559em; left: 0em;"><span class="texatom" id="MathJax-Span-1284"><span class="mrow" id="MathJax-Span-1285"><span class="mstyle" id="MathJax-Span-1286"><span class="mrow" id="MathJax-Span-1287"><span class="mtable" id="MathJax-Span-1288" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px;"><span style="position: absolute; clip: rect(3.025em, 1002.15em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1002.15em, 4.306em, -999.997em); top: -4.301em; left: 50%; margin-left: -1.073em;"><span class="mtd" id="MathJax-Span-1289"><span class="mrow" id="MathJax-Span-1290"><span class="texatom" id="MathJax-Span-1291"><span class="mrow" id="MathJax-Span-1292"><span class="mo" id="MathJax-Span-1293" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1295"><span class="mrow" id="MathJax-Span-1296"><span class="mo" id="MathJax-Span-1297" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1298" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-1299" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.69em, 4.203em, -999.997em); top: -3.532em; left: 50%; margin-left: -0.817em;"><span class="mtd" id="MathJax-Span-1300"><span class="mrow" id="MathJax-Span-1301"><span class="mi" id="MathJax-Span-1302" style="font-size: 70.7%; font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-1303" style="font-size: 70.7%; font-family: MathJax_Main;">⊂</span><span class="mi" id="MathJax-Span-1304" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1305" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-1306" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mrow" id="MathJax-Span-1307"><span class="munderover" id="MathJax-Span-1308"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.08em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Size2; vertical-align: 0em;">⋂</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.34em, 4.306em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-1310"><span class="mrow" id="MathJax-Span-1311"><span class="mi" id="MathJax-Span-1312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1313" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-1314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1315" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1316" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-1317"><span class="mrow" id="MathJax-Span-1318"><span class="mi" id="MathJax-Span-1319" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1320" style="vertical-align: 1.744em;"><span style="display: inline-block; position: relative; width: 0.259em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.225em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.278em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.61em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.944em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.101em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.559em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mi>B</mi></mrow></munder><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>∉</mo><mi>B</mi></mrow></munder><mover><msub><mi>A</mi><mi>j</mi></msub><mo accent="false">¯</mo></mover></mrow><mo>|</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>=</mo><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></munderover><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mi>r</mi></mrow></msup><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mstyle scriptlevel="1"><mtable rowspacing="0.1em" columnspacing="0em" displaystyle="false"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>m</mi></mtd></mtr><mtr><mtd><mi>B</mi><mo>⊂</mo><mi>X</mi></mtd></mtr></mtable></mstyle></mrow></munder><mrow><mo>|</mo><mrow><munder><mo>⋂</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>∈</mo><mi>X</mi></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">\left|\bigcap_{i \in B} A_i \cap \bigcap_{j \not \in B} \overline{A_j}\right|=\sum_{m=r}^{n} (-1)^{m-r} \sum_{\substack{|X|=m \newline B \subset X}}\left|\bigcap_{i\in X} A_{i}\right|</script></p>

<p>The sets on the left side do not intersect for different <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1321" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1322"><span class="mi" id="MathJax-Span-1323" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">B</script>, thus we can sum them up directly. Also one should note that any set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1324" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.82em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1325"><span class="mi" id="MathJax-Span-1326" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">X</script> will always have coefficient <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1327" style="width: 4.46em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.64em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.64em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1328"><span class="mo" id="MathJax-Span-1329" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1331" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-1332"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-1333" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="texatom" id="MathJax-Span-1334"><span class="mrow" id="MathJax-Span-1335"><span class="mi" id="MathJax-Span-1336" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1338" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mi>r</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-64">(-1)^{m-r}</script> if it occurs and it will occur for exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1339" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1002.15em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1340"><span class="mstyle" id="MathJax-Span-1341"><span class="mrow" id="MathJax-Span-1342"><span class="mrow" id="MathJax-Span-1343"><span class="TeXmathchoice" id="MathJax-Span-1344"><span class="texatom" id="MathJax-Span-1345"><span class="mrow" id="MathJax-Span-1346"><span class="mo" id="MathJax-Span-1347" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1348"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.87em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.459em;"><span class="mi" id="MathJax-Span-1349" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-1350" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1351"><span class="texatom" id="MathJax-Span-1352"><span class="mrow" id="MathJax-Span-1353"><span class="mo" id="MathJax-Span-1354" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>m</mi><mi>r</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-65">\dbinom{m}{r}</script> sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1355" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">B</script>.</p>

<h2 id="toc-tgt-7">Usage when solving problems</h2>

<p>The inclusion-exclusion principle is hard to understand without studying its applications.</p>

<p>First, we will look at three simplest tasks "at paper", illustrating applications of the principle, and then consider more practical problems which are difficult to solve without inclusion-exclusion principle.</p>

<p>Tasks asking to "find the <strong>number</strong> of ways" are worth of note, as they sometimes lead to polynomial solutions, not necessarily exponential.</p>

<h3 id="toc-tgt-8">A simple task on permutations</h3>

<p>Task: count how many permutations of numbers from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1358" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1359"><span class="mn" id="MathJax-Span-1360" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-67">0</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1361" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1362"><span class="mn" id="MathJax-Span-1363" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">9</script> exist such that the first element is greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1364" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1365"><span class="mn" id="MathJax-Span-1366" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-69">1</script> and the last one is less than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1367" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1368"><span class="mn" id="MathJax-Span-1369" style="font-family: MathJax_Main;">8</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-70">8</script>.</p>

<p>Let's count the number of "bad" permutations, that is, permutations in which the first element is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1370" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.49em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1371"><span class="mo" id="MathJax-Span-1372" style="font-family: MathJax_Main;">≤</span><span class="mn" id="MathJax-Span-1373" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≤</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-71">\leq 1</script> and/or the last is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1374" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.49em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1375"><span class="mo" id="MathJax-Span-1376" style="font-family: MathJax_Main;">≥</span><span class="mn" id="MathJax-Span-1377" style="font-family: MathJax_Main; padding-left: 0.259em;">8</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-72">\geq 8</script>.</p>

<p>We will denote by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1378" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.82em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1379"><span class="mi" id="MathJax-Span-1380" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">X</script> the set of permutations in which the first element is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1381" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.49em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1382"><span class="mo" id="MathJax-Span-1383" style="font-family: MathJax_Main;">≤</span><span class="mn" id="MathJax-Span-1384" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≤</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-74">\leq 1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1385" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">Y</script> the set of permutations in which the last element is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1388" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.49em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1389"><span class="mo" id="MathJax-Span-1390" style="font-family: MathJax_Main;">≥</span><span class="mn" id="MathJax-Span-1391" style="font-family: MathJax_Main; padding-left: 0.259em;">8</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-76">\geq 8</script>. Then the number of "bad" permutations, as on the inclusion-exclusion formula, will be:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1392" style="width: 15.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.912em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1012.81em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1393"><span class="texatom" id="MathJax-Span-1394"><span class="mrow" id="MathJax-Span-1395"><span class="mo" id="MathJax-Span-1396" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1397" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1398" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="mi" id="MathJax-Span-1399" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-1400"><span class="mrow" id="MathJax-Span-1401"><span class="mo" id="MathJax-Span-1402" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1403" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="texatom" id="MathJax-Span-1404" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-1405"><span class="mo" id="MathJax-Span-1406" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1407" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1408"><span class="mrow" id="MathJax-Span-1409"><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1411" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="texatom" id="MathJax-Span-1412" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1413"><span class="mo" id="MathJax-Span-1414" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1415" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-1416"><span class="mrow" id="MathJax-Span-1417"><span class="mo" id="MathJax-Span-1418" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1419" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="texatom" id="MathJax-Span-1420" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1421"><span class="mo" id="MathJax-Span-1422" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1423" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1424" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-1426"><span class="mrow" id="MathJax-Span-1427"><span class="mo" id="MathJax-Span-1428" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo>∪</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mo>∩</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-77"> |X \cup Y| = |X| + |Y| - |X \cap Y| </script></p>

<p>After a simple combinatorial calculation, we will get to:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1429" style="width: 11.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.48em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1009.38em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1430"><span class="mn" id="MathJax-Span-1431" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1432" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mn" id="MathJax-Span-1433" style="font-family: MathJax_Main; padding-left: 0.207em;">9</span><span class="mo" id="MathJax-Span-1434" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mn" id="MathJax-Span-1436" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-1437" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mn" id="MathJax-Span-1438" style="font-family: MathJax_Main; padding-left: 0.207em;">9</span><span class="mo" id="MathJax-Span-1439" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-1440" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-1441" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-1442" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mn" id="MathJax-Span-1443" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-1444" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mn" id="MathJax-Span-1445" style="font-family: MathJax_Main; padding-left: 0.207em;">8</span><span class="mo" id="MathJax-Span-1446" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>2</mn><mo>⋅</mo><mn>9</mn><mo>!</mo><mo>+</mo><mn>2</mn><mo>⋅</mo><mn>9</mn><mo>!</mo><mo>−</mo><mn>2</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>8</mn><mo>!</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-78"> 2 \cdot 9! + 2 \cdot 9! - 2 \cdot 2 \cdot 8! </script></p>

<p>The only thing left is to subtract this number from the total of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1447" style="width: 1.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.18em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1448"><span class="mn" id="MathJax-Span-1449" style="font-family: MathJax_Main;">10</span><span class="mo" id="MathJax-Span-1450" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>10</mn><mo>!</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">10!</script> to get the number of "good" permutations.</p>

<h3 id="toc-tgt-9">A simple task on (0, 1, 2) sequences</h3>

<p>Task: count how many sequences of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1451" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1452"><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">n</script> exist consisting only of numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1454" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.31em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1455"><span class="mn" id="MathJax-Span-1456" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1457" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1458" style="font-family: MathJax_Main; padding-left: 0.156em;">1</span><span class="mo" id="MathJax-Span-1459" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1460" style="font-family: MathJax_Main; padding-left: 0.156em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-81">0,1,2</script> such that each number occurs <strong>at least once</strong>.</p>

<p>Again let us turn to the inverse problem, i.e. we calculate the number of sequences which do <strong>not</strong> contain <strong>at least one</strong> of the numbers.</p>

<p>Let's denote by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1461" style="width: 7.123em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.843em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1005.74em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1462"><span class="msubsup" id="MathJax-Span-1463"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1464" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1466" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1467" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1468" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1469" style="font-family: MathJax_Main; padding-left: 0.259em;">0</span><span class="mo" id="MathJax-Span-1470" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1471" style="font-family: MathJax_Main; padding-left: 0.156em;">1</span><span class="mo" id="MathJax-Span-1472" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1473" style="font-family: MathJax_Main; padding-left: 0.156em;">2</span><span class="mo" id="MathJax-Span-1474" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82">A_i (i = 0,1,2)</script> the set of sequences in which <strong>at least</strong> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1475" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1476"><span class="mi" id="MathJax-Span-1477" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-83">i</script> of the numbers do <strong>not</strong> occur. The formula of inclusion-exclusion on the number of "bad" sequences will be:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1478" style="width: 46.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 38.169em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1038.07em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1479"><span class="texatom" id="MathJax-Span-1480"><span class="mrow" id="MathJax-Span-1481"><span class="mo" id="MathJax-Span-1482" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1483"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1484" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1485" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1486" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="msubsup" id="MathJax-Span-1487" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1489" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1490" style="font-family: MathJax_Main; padding-left: 0.207em;">∪</span><span class="msubsup" id="MathJax-Span-1491" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1492" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1494"><span class="mrow" id="MathJax-Span-1495"><span class="mo" id="MathJax-Span-1496" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1497" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="texatom" id="MathJax-Span-1498" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-1499"><span class="mo" id="MathJax-Span-1500" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1501"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1504"><span class="mrow" id="MathJax-Span-1505"><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1507" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="texatom" id="MathJax-Span-1508" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1509"><span class="mo" id="MathJax-Span-1510" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1511"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1512" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1514"><span class="mrow" id="MathJax-Span-1515"><span class="mo" id="MathJax-Span-1516" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1517" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="texatom" id="MathJax-Span-1518" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1519"><span class="mo" id="MathJax-Span-1520" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1521"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1523" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1524"><span class="mrow" id="MathJax-Span-1525"><span class="mo" id="MathJax-Span-1526" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1527" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="texatom" id="MathJax-Span-1528" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1529"><span class="mo" id="MathJax-Span-1530" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1531"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1532" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1533" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1534" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1535" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1537" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1538"><span class="mrow" id="MathJax-Span-1539"><span class="mo" id="MathJax-Span-1540" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1541" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="texatom" id="MathJax-Span-1542" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1543"><span class="mo" id="MathJax-Span-1544" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1545"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1546" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1547" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1549" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1550" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1551" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1552"><span class="mrow" id="MathJax-Span-1553"><span class="mo" id="MathJax-Span-1554" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1555" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="texatom" id="MathJax-Span-1556" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1557"><span class="mo" id="MathJax-Span-1558" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1559"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1560" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1562" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1563" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1564" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1566"><span class="mrow" id="MathJax-Span-1567"><span class="mo" id="MathJax-Span-1568" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1569" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="texatom" id="MathJax-Span-1570" style="padding-left: 0.207em;"><span class="mrow" id="MathJax-Span-1571"><span class="mo" id="MathJax-Span-1572" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1573"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1574" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1575" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1576" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1577" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1578" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1579" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1580" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1581" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1582" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mn" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1584"><span class="mrow" id="MathJax-Span-1585"><span class="mo" id="MathJax-Span-1586" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>0</mn></msub><mo>∪</mo><msub><mi>A</mi><mn>1</mn></msub><mo>∪</mo><msub><mi>A</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>0</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>0</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>0</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mn>0</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>A</mi><mn>2</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-84"> |A_0 \cup A_1 \cup A_2| = |A_0| + |A_1| + |A_2| - |A_0 \cap A_1| - |A_0 \cap A_2| - |A_1 \cap A_2| + |A_0 \cap A_1 \cap A_2| </script></p>

<ul>
<li>The size of each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1587" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1588"><span class="msubsup" id="MathJax-Span-1589"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1590" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1591" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-85">A_i</script> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1592" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.03em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1593"><span class="msubsup" id="MathJax-Span-1594"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1595" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-1596" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-86">2^n</script>, as each sequence can only contain two of the digits.</li>
<li>The size of each pairwise intersection <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1597" style="width: 3.998em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.281em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1003.28em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1598"><span class="msubsup" id="MathJax-Span-1599"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1601" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1602" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1603" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1604" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-87">A_i \cap A_j</script>  is equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1606" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1607"><span class="mn" id="MathJax-Span-1608" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-88">1</script>, as there will be only one digit to build the sequence.</li>
<li>The size of the intersection of all three sets is equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1609" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1610"><span class="mn" id="MathJax-Span-1611" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-89">0</script>, as there will be no digits to build the sequence.</li>
</ul>

<p>As we solved the inverse problem, we subtract it from the total of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1612" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.03em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1613"><span class="msubsup" id="MathJax-Span-1614"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1615" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-1616" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>3</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-90">3^n</script> sequences:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1617" style="width: 11.939em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.787em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1009.68em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1618"><span class="msubsup" id="MathJax-Span-1619"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1620" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-1621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1622" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-1623" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mn" id="MathJax-Span-1624" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1625" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="msubsup" id="MathJax-Span-1626" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1627" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1629" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-1630" style="font-family: MathJax_Main; padding-left: 0.207em;">3</span><span class="mo" id="MathJax-Span-1631" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mn" id="MathJax-Span-1632" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mn" id="MathJax-Span-1634" style="font-family: MathJax_Main; padding-left: 0.207em;">0</span><span class="mo" id="MathJax-Span-1635" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mn>3</mn><mi>n</mi></msup><mo>−</mo><mo stretchy="false">(</mo><mn>3</mn><mo>⋅</mo><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>3</mn><mo>⋅</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-91">3^n - (3 \cdot 2^n - 3 \cdot 1 + 0)</script></p>

<h3 id="toc-tgt-10">The number of integer solutions to the equation</h3>

<p>Consider the following equation:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1636" style="width: 17.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.398em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1014.35em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1637"><span class="msubsup" id="MathJax-Span-1638"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1639" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1640" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1641" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="msubsup" id="MathJax-Span-1642" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1643" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1645" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="msubsup" id="MathJax-Span-1646" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1647" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1648" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1649" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="msubsup" id="MathJax-Span-1650" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1651" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1652" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1653" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="msubsup" id="MathJax-Span-1654" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1655" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1656" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1657" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="msubsup" id="MathJax-Span-1658" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1659" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mn" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1661" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1662" style="font-family: MathJax_Main; padding-left: 0.259em;">20</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><msub><mi>x</mi><mn>4</mn></msub><mo>+</mo><msub><mi>x</mi><mn>5</mn></msub><mo>+</mo><msub><mi>x</mi><mn>6</mn></msub><mo>=</mo><mn>20</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-92">x_1 + x_2 + x_3 + x_4 + x_5 + x_6 = 20</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1663" style="width: 12.912em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.556em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1010.45em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1664"><span class="mn" id="MathJax-Span-1665" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1666" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="msubsup" id="MathJax-Span-1667" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1668" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1669" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1670" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="mn" id="MathJax-Span-1671" style="font-family: MathJax_Main; padding-left: 0.259em;">8</span><span class="mo" id="MathJax-Span-1672" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1674" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1675" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-1676" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1677" style="font-family: MathJax_Main; padding-left: 0.156em;">2</span><span class="mo" id="MathJax-Span-1678" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1679" style="font-family: MathJax_Main; padding-left: 0.156em;">…</span><span class="mn" id="MathJax-Span-1680" style="font-family: MathJax_Main; padding-left: 0.156em;">6</span><span class="mo" id="MathJax-Span-1681" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><mn>8</mn><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mn>6</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-93">0 \le x_i \le 8 (i = 1,2,\ldots 6)</script>.</p>

<p>Task: count the number of solutions to the equation.</p>

<p>Forget the restriction on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1682" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1683"><span class="msubsup" id="MathJax-Span-1684"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1685" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">x_i</script> for a moment and just count the number of nonnegative solutions to this equation. This is easily done using <a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">binomial coefficients</a>: we want to break a sequence of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1687" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.98em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1688"><span class="mn" id="MathJax-Span-1689" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>20</mn></math></span></span><script type="math/tex" id="MathJax-Element-95">20</script> units into <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1690" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1691"><span class="mn" id="MathJax-Span-1692" style="font-family: MathJax_Main;">6</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>6</mn></math></span></span><script type="math/tex" id="MathJax-Element-96">6</script> groups, which is the same as distributing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1693" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1694"><span class="mn" id="MathJax-Span-1695" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-97">5</script> "walls" over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1696" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.98em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1697"><span class="mn" id="MathJax-Span-1698" style="font-family: MathJax_Main;">25</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>25</mn></math></span></span><script type="math/tex" id="MathJax-Element-98">25</script> slots:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1699" style="width: 6.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.023em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1004.82em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1700"><span class="msubsup" id="MathJax-Span-1701"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.87em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1702" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.822em;"><span class="mn" id="MathJax-Span-1703" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1704" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mrow" id="MathJax-Span-1705" style="padding-left: 0.259em;"><span class="TeXmathchoice" id="MathJax-Span-1706"><span class="texatom" id="MathJax-Span-1707"><span class="mrow" id="MathJax-Span-1708"><span class="mo" id="MathJax-Span-1709" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1710"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.51em;"><span class="mn" id="MathJax-Span-1711" style="font-family: MathJax_Main;">25</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1712" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1713"><span class="texatom" id="MathJax-Span-1714"><span class="mrow" id="MathJax-Span-1715"><span class="mo" id="MathJax-Span-1716" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>N</mi><mn>0</mn></msub><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>25</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">N_0 = \binom{25}{5}</script></p>

<p>We will now calculate the number of "bad" solutions with the inclusion-exclusion principle. The "bad" solutions will be those in which one or more <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1717" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1718"><span class="msubsup" id="MathJax-Span-1719"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1720" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1721" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">x_i</script> are greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1722" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1723"><span class="mn" id="MathJax-Span-1724" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-101">9</script>.</p>

<p>Denote by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1725" style="width: 8.763em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.175em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1007.07em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1726"><span class="msubsup" id="MathJax-Span-1727"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1728" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1729" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1730" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1731" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1732" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1733" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-1734" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-1735" style="font-family: MathJax_Main; padding-left: 0.156em;">2</span><span class="mo" id="MathJax-Span-1736" style="font-family: MathJax_Main; padding-left: 0.156em;">…</span><span class="mn" id="MathJax-Span-1737" style="font-family: MathJax_Main; padding-left: 0.156em;">6</span><span class="mo" id="MathJax-Span-1738" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>…</mo><mn>6</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-102">A_k (k = 1,2\ldots 6)</script> the set of solutions where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1739" style="width: 3.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.82em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.77em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1740"><span class="msubsup" id="MathJax-Span-1741"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1742" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1743" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1744" style="font-family: MathJax_Main; padding-left: 0.259em;">≥</span><span class="mn" id="MathJax-Span-1745" style="font-family: MathJax_Main; padding-left: 0.259em;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>k</mi></msub><mo>≥</mo><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-103">x_k \ge 9</script>, and all other <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1746" style="width: 6.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.587em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1005.48em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1747"><span class="msubsup" id="MathJax-Span-1748"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1749" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="mi" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1751" style="font-family: MathJax_Main; padding-left: 0.259em;">≥</span><span class="mn" id="MathJax-Span-1752" style="font-family: MathJax_Main; padding-left: 0.259em;">0</span><span class="mo" id="MathJax-Span-1753" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1754" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1755" style="font-family: MathJax_Main; padding-left: 0.259em;">≠</span><span class="mi" id="MathJax-Span-1756" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">k</span><span class="mo" id="MathJax-Span-1757" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>i</mi></msub><mo>≥</mo><mn>0</mn><mo stretchy="false">(</mo><mi>i</mi><mo>≠</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">x_i \ge 0 (i \ne k)</script> (they may be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1758" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.49em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1759"><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main;">≥</span><span class="mn" id="MathJax-Span-1761" style="font-family: MathJax_Main; padding-left: 0.259em;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-105">\ge 9</script> or not). To calculate the size of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1762" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.18em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1763"><span class="msubsup" id="MathJax-Span-1764"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1765" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-106">A_k</script>, note that we have essentially the same combinatorial problem that was solved in the two paragraphs above, but now <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1767" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1768"><span class="mn" id="MathJax-Span-1769" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-107">9</script> of the units are excluded from the slots and definitely belong to the first group. Thus:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1770" style="width: 6.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.535em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1005.33em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1771"><span class="texatom" id="MathJax-Span-1772"><span class="mrow" id="MathJax-Span-1773"><span class="mo" id="MathJax-Span-1774" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1775"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1776" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1777" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1778"><span class="mrow" id="MathJax-Span-1779"><span class="mo" id="MathJax-Span-1780" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1781" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mrow" id="MathJax-Span-1782" style="padding-left: 0.259em;"><span class="TeXmathchoice" id="MathJax-Span-1783"><span class="texatom" id="MathJax-Span-1784"><span class="mrow" id="MathJax-Span-1785"><span class="mo" id="MathJax-Span-1786" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1787"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.51em;"><span class="mn" id="MathJax-Span-1788" style="font-family: MathJax_Main;">16</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1789" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1790"><span class="texatom" id="MathJax-Span-1791"><span class="mrow" id="MathJax-Span-1792"><span class="mo" id="MathJax-Span-1793" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>A</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>16</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-108"> | A_k | = \binom{16}{5} </script></p>

<p>Similarly, the size of the intersection between sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1794" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.18em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1795"><span class="msubsup" id="MathJax-Span-1796"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1797" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-109">A_k</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1799" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.18em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1800"><span class="msubsup" id="MathJax-Span-1801"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1802" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1803" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>p</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-110">A_p</script> is equal to:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1804" style="width: 8.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.277em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1007.07em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1805"><span class="mrow" id="MathJax-Span-1806"><span class="mo" id="MathJax-Span-1807" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mrow" id="MathJax-Span-1808"><span class="msubsup" id="MathJax-Span-1809"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1810" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1811" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1812" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-1813" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1814" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-1815" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-1816" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1817" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mrow" id="MathJax-Span-1818" style="padding-left: 0.259em;"><span class="TeXmathchoice" id="MathJax-Span-1819"><span class="texatom" id="MathJax-Span-1820"><span class="mrow" id="MathJax-Span-1821"><span class="mo" id="MathJax-Span-1822" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1823"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1824" style="font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1825" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1826"><span class="texatom" id="MathJax-Span-1827"><span class="mrow" id="MathJax-Span-1828"><span class="mo" id="MathJax-Span-1829" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><msub><mi>A</mi><mi>k</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>p</mi></msub></mrow><mo>|</mo></mrow><mo>=</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>7</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-111"> \left| A_k \cap A_p \right| = \binom{7}{5}</script></p>

<p>The size of each intersection of three sets is zero, since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1830" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.98em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1831"><span class="mn" id="MathJax-Span-1832" style="font-family: MathJax_Main;">20</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>20</mn></math></span></span><script type="math/tex" id="MathJax-Element-112">20</script> units will not be enough for three or more variables greater than or equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1833" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1834"><span class="mn" id="MathJax-Span-1835" style="font-family: MathJax_Main;">9</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>9</mn></math></span></span><script type="math/tex" id="MathJax-Element-113">9</script>.</p>

<p>Combining all this into the formula of inclusions-exceptions and given that we solved the inverse problem, we finally get the answer:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;25&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1836" style="width: 19.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.191em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1015.99em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1837"><span class="mrow" id="MathJax-Span-1838"><span class="TeXmathchoice" id="MathJax-Span-1839"><span class="texatom" id="MathJax-Span-1840"><span class="mrow" id="MathJax-Span-1841"><span class="mo" id="MathJax-Span-1842" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1843"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.51em;"><span class="mn" id="MathJax-Span-1844" style="font-family: MathJax_Main;">25</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1845" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1846"><span class="texatom" id="MathJax-Span-1847"><span class="mrow" id="MathJax-Span-1848"><span class="mo" id="MathJax-Span-1849" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-1850" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-1851" style="padding-left: 0.207em;"><span class="mo" id="MathJax-Span-1852" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-1853"><span class="mrow" id="MathJax-Span-1854"><span class="TeXmathchoice" id="MathJax-Span-1855"><span class="texatom" id="MathJax-Span-1856"><span class="mrow" id="MathJax-Span-1857"><span class="mo" id="MathJax-Span-1858" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1859"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1860" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1861" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1862"><span class="texatom" id="MathJax-Span-1863"><span class="mrow" id="MathJax-Span-1864"><span class="mo" id="MathJax-Span-1865" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-1866" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-1867" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-1868"><span class="texatom" id="MathJax-Span-1869"><span class="mrow" id="MathJax-Span-1870"><span class="mo" id="MathJax-Span-1871" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1872"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.51em;"><span class="mn" id="MathJax-Span-1873" style="font-family: MathJax_Main;">16</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1874" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1875"><span class="texatom" id="MathJax-Span-1876"><span class="mrow" id="MathJax-Span-1877"><span class="mo" id="MathJax-Span-1878" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-1879" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-1880" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-1881"><span class="texatom" id="MathJax-Span-1882"><span class="mrow" id="MathJax-Span-1883"><span class="mo" id="MathJax-Span-1884" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1885"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1886" style="font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1887" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1888"><span class="texatom" id="MathJax-Span-1889"><span class="mrow" id="MathJax-Span-1890"><span class="mo" id="MathJax-Span-1891" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-1892" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-1893" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-1894"><span class="texatom" id="MathJax-Span-1895"><span class="mrow" id="MathJax-Span-1896"><span class="mo" id="MathJax-Span-1897" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-1898"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1899" style="font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-1900" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-1901"><span class="texatom" id="MathJax-Span-1902"><span class="mrow" id="MathJax-Span-1903"><span class="mo" id="MathJax-Span-1904" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1905" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>25</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>−</mo><mrow><mo>(</mo><mrow><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>6</mn><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>16</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>6</mn><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mn>7</mn><mn>5</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></mrow><mo>)</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-114">\binom{25}{5} - \left(\binom{6}{1} \cdot \binom{16}{5} - \binom{6}{2} \cdot \binom{7}{5}\right) </script></p>

<h3 id="toc-tgt-11">The number of relative primes in a given interval</h3>

<p>Task: given two numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1906" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1907"><span class="mi" id="MathJax-Span-1908" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">n</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1909" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1910"><span class="mi" id="MathJax-Span-1911" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">r</script>, count the number of integers in the interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1912" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1913"><span class="mo" id="MathJax-Span-1914" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1915" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1916" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-1918" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>;</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">[1;r]</script> that are relatively prime to n (their greatest common divisor is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1919" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1920"><span class="mn" id="MathJax-Span-1921" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-118">1</script>).</p>

<p>Let's solve the inverse problem - compute the number of not mutually primes with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1922" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1923"><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">n</script>.</p>

<p>We will denote the prime factors of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1925" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1926"><span class="mi" id="MathJax-Span-1927" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">n</script> as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1928" style="width: 7.021em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.74em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1005.64em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1929"><span class="msubsup" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1931" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1933" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1934" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1935" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-1936" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-1937" style="font-family: MathJax_Main; padding-left: 0.156em;">⋯</span><span class="mi" id="MathJax-Span-1938" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">k</span><span class="mo" id="MathJax-Span-1939" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>⋯</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">p_i (i = 1\cdots k)</script>.</p>

<p>How many numbers in the interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1940" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1941"><span class="mo" id="MathJax-Span-1942" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1943" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1944" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-1945" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-1946" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>;</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-122">[1;r]</script> are divisible by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1947" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.82em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1948"><span class="msubsup" id="MathJax-Span-1949"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1950" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1951" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">p_i</script>? The answer to this question is:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x230A;&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x230B;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1952" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1002.05em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-1953"><span class="mrow" id="MathJax-Span-1954"><span class="mo" id="MathJax-Span-1955" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">⌊</span></span><span class="mfrac" id="MathJax-Span-1956"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-1957" style="font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.82em, 4.357em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.407em;"><span class="msubsup" id="MathJax-Span-1958"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1959" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.92em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.925em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-1961" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">⌋</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>⌊</mo><mfrac><mi>r</mi><msub><mi>p</mi><mi>i</mi></msub></mfrac><mo>⌋</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-124"> \left\lfloor \frac{ r }{ p_i } \right\rfloor </script></p>

<p>However, if we simply sum these numbers, some numbers will be summarized several times (those that share multiple <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1962" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.82em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1963"><span class="msubsup" id="MathJax-Span-1964"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1965" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1966" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-125">p_i</script> as their factors). Therefore, it is necessary to use the inclusion-exclusion principle.</p>

<p>We will iterate over all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1967" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1000.92em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1968"><span class="msubsup" id="MathJax-Span-1969"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-1970" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-1971" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-126">2^k</script> subsets of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1972" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.82em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1973"><span class="msubsup" id="MathJax-Span-1974"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1975" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">p_i</script>s, calculate their product and add or subtract the number of multiples of their product.</p>

<p>Here is a C++ implementation:</p>

<pre><code class="cpp hljs"><span class="hljs-keyword">int</span> solve (<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> r) {
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> p;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>; i*i&lt;=n; ++i)
        <span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>) {
            p.push_back (i);
            <span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>)
                n /= i;
        }
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>)
        p.push_back (n);

    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> msk=<span class="hljs-number">1</span>; msk&lt;(<span class="hljs-number">1</span>&lt;&lt;p.size()); ++msk) {
        <span class="hljs-keyword">int</span> mult = <span class="hljs-number">1</span>,
            bits = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;(<span class="hljs-keyword">int</span>)p.size(); ++i)
            <span class="hljs-keyword">if</span> (msk &amp; (<span class="hljs-number">1</span>&lt;&lt;i)) {
                ++bits;
                mult *= p[i];
            }

        <span class="hljs-keyword">int</span> cur = r / mult;
        <span class="hljs-keyword">if</span> (bits % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>)
            sum += cur;
        <span class="hljs-keyword">else</span>
            sum -= cur;
    }

    <span class="hljs-keyword">return</span> r - sum;
}
</code></pre>

<p>Asymptotics of the solution is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msqrt&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msqrt&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1977" style="width: 3.794em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.97em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1978"><span class="mi" id="MathJax-Span-1979" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1980" style="font-family: MathJax_Main;">(</span><span class="msqrt" id="MathJax-Span-1981"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0.822em;"><span class="mrow" id="MathJax-Span-1982"><span class="mi" id="MathJax-Span-1983" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.589em, 1000.72em, 3.947em, -999.997em); top: -4.454em; left: 0.822em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.993em; left: -0.1em;">−<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -3.993em; left: 0.003em;">−<span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.025em, 1000.87em, 4.357em, -999.997em); top: -3.942em; left: 0em;"><span style="font-family: MathJax_Main;">√</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-1984" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msqrt><mi>n</mi></msqrt><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-128">O (\sqrt{n})</script>.</p>

<h3 id="toc-tgt-12">The number of integers in a given interval which are multiple of at least one of the given numbers</h3>

<p>Given <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1985" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1986"><span class="mi" id="MathJax-Span-1987" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">n</script> numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1988" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1989"><span class="msubsup" id="MathJax-Span-1990"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-1991" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-1992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-130">a_i</script> and number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1993" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1994"><span class="mi" id="MathJax-Span-1995" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">r</script>. You want to count the number of integers in the interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1996" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-1997"><span class="mo" id="MathJax-Span-1998" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1999" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2000" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-2001" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-2002" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>;</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-132">[1; r]</script> that are multiple of at least one of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2003" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2004"><span class="msubsup" id="MathJax-Span-2005"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2006" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-2007" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-133">a_i</script>.</p>

<p>The solution algorithm is almost identical to the one for previous task — construct the formula of inclusion-exclusion on the numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2008" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2009"><span class="msubsup" id="MathJax-Span-2010"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2011" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-2012" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">a_i</script>, i.e. each term in this formula is the number of numbers divisible by a given subset of numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2013" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2014"><span class="msubsup" id="MathJax-Span-2015"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2016" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-2017" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-135">a_i</script> (in other words, divisible by their <a href="https://cp-algorithms.com/algebra/euclid-algorithm.html">least common multiple</a>).</p>

<p>So we will now iterate over all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2018" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.03em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2019"><span class="msubsup" id="MathJax-Span-2020"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2021" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2022" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-136">2^n</script> subsets of integers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2023" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2024"><span class="msubsup" id="MathJax-Span-2025"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2026" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-2027" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-137">a_i</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2028" style="width: 5.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.203em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.1em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2029"><span class="mi" id="MathJax-Span-2030" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2031" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2032" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2033" style="font-family: MathJax_Main; padding-left: 0.156em;">log</span><span class="mo" id="MathJax-Span-2034"></span><span class="mi" id="MathJax-Span-2035" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-2036" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-138">O(n \log r)</script> operations to find their least common multiple, adding or subtracting the number of multiples of it in the interval. Asymptotics is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2037" style="width: 7.892em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.457em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1006.36em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2038"><span class="mi" id="MathJax-Span-2039" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2040" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2041"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2042" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2044" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">n</span><span class="mo" id="MathJax-Span-2046" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2047" style="font-family: MathJax_Main; padding-left: 0.207em;">log</span><span class="mo" id="MathJax-Span-2048"></span><span class="mi" id="MathJax-Span-2049" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-2050" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo>⋅</mo><mi>n</mi><mo>⋅</mo><mi>log</mi><mo>⁡</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-139">O (2^n\cdot n\cdot \log r)</script>.</p>

<h3 id="toc-tgt-13">The number of strings that satisfy a given pattern</h3>

<p>Consider <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2051" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2052"><span class="mi" id="MathJax-Span-2053" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">n</script> patterns of strings of the same length, consisting only of letters (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2054" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1002.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2055"><span class="mi" id="MathJax-Span-2056" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2057" style="font-family: MathJax_Main;">.</span><span class="mo" id="MathJax-Span-2058" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-2059" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mi" id="MathJax-Span-2060" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>.</mo><mo>.</mo><mo>.</mo><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-141">a...z</script>) or question marks. You're also given a number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2061" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2062"><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">k</script>. A string matches a pattern if it has the same length as the pattern, and at each position, either the corresponding characters are equal or the character in the pattern is a question mark. The task is to count the number of strings that match exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2064" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2065"><span class="mi" id="MathJax-Span-2066" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">k</script> of the patterns (first problem) and at least <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2067" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2068"><span class="mi" id="MathJax-Span-2069" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">k</script> of the patterns (second problem).</p>

<p>Notice first that we can easily count the number of strings that satisfy at once all of the specified patterns. To do this, simply "cross" patterns: iterate though the positions ("slots") and look at a position over all patterns. If all patterns have a question mark in this position, the character can be any letter from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2070" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2071"><span class="mi" id="MathJax-Span-2072" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">a</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2073" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2074"><span class="mi" id="MathJax-Span-2075" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">z</script>. Otherwise, the character of this position is uniquely defined by the patterns that do not contain a question mark.</p>

<p>Learn now to solve the first version of the problem: when the string must satisfy exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2076" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2077"><span class="mi" id="MathJax-Span-2078" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">k</script> of the patterns.</p>

<p>To solve it, iterate and fix a specific subset <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2079" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.82em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2080"><span class="mi" id="MathJax-Span-2081" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">X</script> from the set of patterns consisting of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2082" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2083"><span class="mi" id="MathJax-Span-2084" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">k</script> patterns. Then we have to count the number of strings that satisfy this set of patterns, and only matches it, that is, they don't match any other pattern. We will use the inclusion-exclusion principle in a slightly different manner: we sum on all supersets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2085" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2086"><span class="mi" id="MathJax-Span-2087" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">Y</script> (subsets from the original set of strings that contain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2088" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.82em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2089"><span class="mi" id="MathJax-Span-2090" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">X</script>), and either add to the current answer of subtract it from the number of strings:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2287;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2091" style="width: 15.832em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.964em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1012.86em, 3.64em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2092"><span class="mi" id="MathJax-Span-2093" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2094" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2095" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2096" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2097" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2098" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2099" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-2100" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.105em;"><span class="mo" id="MathJax-Span-2101" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.69em, 4.357em, -999.997em); top: -2.918em; left: 0em;"><span class="texatom" id="MathJax-Span-2102"><span class="mrow" id="MathJax-Span-2103"><span class="mi" id="MathJax-Span-2104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="mo" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Main;">⊇</span><span class="mi" id="MathJax-Span-2106" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2107" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2108" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2109" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2110"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2111" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2112"><span class="mrow" id="MathJax-Span-2113"><span class="texatom" id="MathJax-Span-2114"><span class="mrow" id="MathJax-Span-2115"><span class="mo" id="MathJax-Span-2116" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2118"><span class="mrow" id="MathJax-Span-2119"><span class="mo" id="MathJax-Span-2120" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2121" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2123" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2124" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2125" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2126" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="mo" id="MathJax-Span-2127" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>Y</mi><mo>⊇</mo><mi>X</mi></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-152"> ans(X) = \sum_{Y \supseteq X} (-1)^{|Y|-k} \cdot f(Y) </script></p>

<p>Where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2128" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2129"><span class="mi" id="MathJax-Span-2130" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2132" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="mo" id="MathJax-Span-2133" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">f(Y)</script> is the number of strings that match <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2134" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2135"><span class="mi" id="MathJax-Span-2136" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-154">Y</script> (at least <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2137" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2138"><span class="mi" id="MathJax-Span-2139" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">Y</script>).</p>

<p>(If you have a hard time figuring out this, you can try drawing Venn Diagrams.)</p>

<p>If we sum up on all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2140" style="width: 3.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.13em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2141"><span class="mi" id="MathJax-Span-2142" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2143" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2144" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2146" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2147" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-156">ans(X)</script>, we will get the final answer:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2148" style="width: 11.376em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.326em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1009.22em, 3.794em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2149"><span class="mi" id="MathJax-Span-2150" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2151" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2152" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-2154" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 3.076em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.822em;"><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1003.08em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-2156"><span class="mrow" id="MathJax-Span-2157"><span class="mi" id="MathJax-Span-2158" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2159" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-2160" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mtext" id="MathJax-Span-2161" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2162"><span class="mrow" id="MathJax-Span-2163"><span class="mo" id="MathJax-Span-2164" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-2166"><span class="mrow" id="MathJax-Span-2167"><span class="mo" id="MathJax-Span-2168" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2169" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-2170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-2171" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">a</span><span class="mi" id="MathJax-Span-2172" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2173" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2174" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2175" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2176" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>X</mi><mtext>&nbsp;</mtext><mo>:</mo><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mi>k</mi></mrow></munder><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-157"> ans = \sum_{X ~ : ~ |X| = k} ans(X) </script></p>

<p>However, asymptotics of this solution is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2177" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.59em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2178"><span class="mi" id="MathJax-Span-2179" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2180" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2181"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2182" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2184" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2185" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span><span class="mo" id="MathJax-Span-2186" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>3</mn><mi>k</mi></msup><mo>⋅</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-158">O(3^k \cdot k)</script>. To improve it, notice that different <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2187" style="width: 3.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.13em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2188"><span class="mi" id="MathJax-Span-2189" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2190" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2191" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2192" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2193" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2194" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-159">ans(X)</script> computations very often share <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2195" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2196"><span class="mi" id="MathJax-Span-2197" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">Y</script> sets.</p>

<p>We will reverse the formula of inclusion-exclusion and sum in terms of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2198" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2199"><span class="mi" id="MathJax-Span-2200" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-161">Y</script> sets. Now it becomes clear that the same set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2201" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2202"><span class="mi" id="MathJax-Span-2203" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">Y</script> would be taken into account in the computation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2204" style="width: 3.947em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.13em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2205"><span class="mi" id="MathJax-Span-2206" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2207" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2208" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2209" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2210" style="font-family: MathJax_Math-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2211" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>n</mi><mi>s</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-163">ans(X)</script> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2212" style="width: 2.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.13em, 1001.69em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-2213"><span class="mrow" id="MathJax-Span-2214"><span class="TeXmathchoice" id="MathJax-Span-2215"><span class="texatom" id="MathJax-Span-2216"><span class="mrow" id="MathJax-Span-2217"><span class="mo" id="MathJax-Span-2218" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2219"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.87em, 4.306em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-2220"><span class="texatom" id="MathJax-Span-2221"><span class="mrow" id="MathJax-Span-2222"><span class="mo" id="MathJax-Span-2223" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2224" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2225"><span class="mrow" id="MathJax-Span-2226"><span class="mo" id="MathJax-Span-2227" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1000.36em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-2228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2229"><span class="texatom" id="MathJax-Span-2230"><span class="mrow" id="MathJax-Span-2231"><span class="mo" id="MathJax-Span-2232" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-164">\binom{|Y|}{k}</script> sets with the same sign <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2233" style="width: 4.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1004em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2234"><span class="mo" id="MathJax-Span-2235" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2236" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2237" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2238"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2239" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2240"><span class="mrow" id="MathJax-Span-2241"><span class="texatom" id="MathJax-Span-2242"><span class="mrow" id="MathJax-Span-2243"><span class="mo" id="MathJax-Span-2244" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2245" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2246"><span class="mrow" id="MathJax-Span-2247"><span class="mo" id="MathJax-Span-2248" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2250" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-165">(-1)^{|Y| - k}</script>.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2251" style="width: 19.623em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.089em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1015.99em, 5.023em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2252"><span class="mi" id="MathJax-Span-2253" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2254" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2255" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2256" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-2257" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.923em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.771em;"><span class="mo" id="MathJax-Span-2258" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.92em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-2259"><span class="mrow" id="MathJax-Span-2260"><span class="mi" id="MathJax-Span-2261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="mtext" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-2263" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mtext" id="MathJax-Span-2264" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2265"><span class="mrow" id="MathJax-Span-2266"><span class="mo" id="MathJax-Span-2267" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2268" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2269"><span class="mrow" id="MathJax-Span-2270"><span class="mo" id="MathJax-Span-2271" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2272" style="font-size: 70.7%; font-family: MathJax_Main;">≥</span><span class="mi" id="MathJax-Span-2273" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2274" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2275" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2276" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2277"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2278" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2279"><span class="mrow" id="MathJax-Span-2280"><span class="texatom" id="MathJax-Span-2281"><span class="mrow" id="MathJax-Span-2282"><span class="mo" id="MathJax-Span-2283" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2284" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2285"><span class="mrow" id="MathJax-Span-2286"><span class="mo" id="MathJax-Span-2287" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2289" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2290" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2291" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2292"><span class="texatom" id="MathJax-Span-2293"><span class="mrow" id="MathJax-Span-2294"><span class="mo" id="MathJax-Span-2295" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2296"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2297"><span class="texatom" id="MathJax-Span-2298"><span class="mrow" id="MathJax-Span-2299"><span class="mo" id="MathJax-Span-2300" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2301" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2302"><span class="mrow" id="MathJax-Span-2303"><span class="mo" id="MathJax-Span-2304" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-2305" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2306"><span class="texatom" id="MathJax-Span-2307"><span class="mrow" id="MathJax-Span-2308"><span class="mo" id="MathJax-Span-2309" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2310" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2311" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2312" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2313" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="mo" id="MathJax-Span-2314" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>Y</mi><mtext>&nbsp;</mtext><mo>:</mo><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mi>k</mi></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-166"> ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot \binom{|Y|}{k} \cdot f(Y) </script></p>

<p>Now our solution has asymptotics <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2315" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.59em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2316"><span class="mi" id="MathJax-Span-2317" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2318" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2319"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2320" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2322" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2323" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span><span class="mo" id="MathJax-Span-2324" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>k</mi></msup><mo>⋅</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">O(2^k \cdot k)</script>.</p>

<p>We will now solve the second version of the problem: find the number of strings that match <strong>at least</strong> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2325" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2326"><span class="mi" id="MathJax-Span-2327" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-168">k</script> of the patterns.</p>

<p>Of course, we can just use the solution to the first version of the problem and add the answers for sets with size greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2328" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2329"><span class="mi" id="MathJax-Span-2330" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">k</script>. However, you may notice that in this problem, a set |Y| is considered in the formula for all sets with size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2331" style="width: 1.898em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.539em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.54em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2332"><span class="mo" id="MathJax-Span-2333" style="font-family: MathJax_Main;">≥</span><span class="mi" id="MathJax-Span-2334" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≥</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-170">\ge k</script> which are contained in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2335" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.77em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2336"><span class="mi" id="MathJax-Span-2337" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-171">Y</script>. That said, we can write the part of the expression that is being multiplied by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2338" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2339"><span class="mi" id="MathJax-Span-2340" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2341" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2342" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="mo" id="MathJax-Span-2343" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-172">f(Y)</script> as:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2344" style="width: 48.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 39.962em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1039.76em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2345"><span class="mo" id="MathJax-Span-2346" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2347" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2348" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2349"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2350" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2351"><span class="mrow" id="MathJax-Span-2352"><span class="texatom" id="MathJax-Span-2353"><span class="mrow" id="MathJax-Span-2354"><span class="mo" id="MathJax-Span-2355" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2356" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2357"><span class="mrow" id="MathJax-Span-2358"><span class="mo" id="MathJax-Span-2359" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2360" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2361" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2362" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2363" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2364"><span class="texatom" id="MathJax-Span-2365"><span class="mrow" id="MathJax-Span-2366"><span class="mo" id="MathJax-Span-2367" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2368"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2369"><span class="texatom" id="MathJax-Span-2370"><span class="mrow" id="MathJax-Span-2371"><span class="mo" id="MathJax-Span-2372" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2373" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2374"><span class="mrow" id="MathJax-Span-2375"><span class="mo" id="MathJax-Span-2376" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-2377" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2378"><span class="texatom" id="MathJax-Span-2379"><span class="mrow" id="MathJax-Span-2380"><span class="mo" id="MathJax-Span-2381" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2382" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-2383" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-2384" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2385" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2386"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2387" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2388"><span class="mrow" id="MathJax-Span-2389"><span class="texatom" id="MathJax-Span-2390"><span class="mrow" id="MathJax-Span-2391"><span class="mo" id="MathJax-Span-2392" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2393" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2394"><span class="mrow" id="MathJax-Span-2395"><span class="mo" id="MathJax-Span-2396" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2397" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2398" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2399" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2400" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2401" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2402" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2403"><span class="texatom" id="MathJax-Span-2404"><span class="mrow" id="MathJax-Span-2405"><span class="mo" id="MathJax-Span-2406" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2407"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2408"><span class="texatom" id="MathJax-Span-2409"><span class="mrow" id="MathJax-Span-2410"><span class="mo" id="MathJax-Span-2411" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2412" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2413"><span class="mrow" id="MathJax-Span-2414"><span class="mo" id="MathJax-Span-2415" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1002.15em, 4.255em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.124em;"><span class="mrow" id="MathJax-Span-2416"><span class="mi" id="MathJax-Span-2417" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2418" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mn" id="MathJax-Span-2419" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2420"><span class="texatom" id="MathJax-Span-2421"><span class="mrow" id="MathJax-Span-2422"><span class="mo" id="MathJax-Span-2423" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2424" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-2425" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-2426" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2427" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2428"><span style="display: inline-block; position: relative; width: 3.23em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2429" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2430"><span class="mrow" id="MathJax-Span-2431"><span class="texatom" id="MathJax-Span-2432"><span class="mrow" id="MathJax-Span-2433"><span class="mo" id="MathJax-Span-2434" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2435" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2436"><span class="mrow" id="MathJax-Span-2437"><span class="mo" id="MathJax-Span-2438" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2439" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2441" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2442" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2443" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2444" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2445"><span class="texatom" id="MathJax-Span-2446"><span class="mrow" id="MathJax-Span-2447"><span class="mo" id="MathJax-Span-2448" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2449"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2450"><span class="texatom" id="MathJax-Span-2451"><span class="mrow" id="MathJax-Span-2452"><span class="mo" id="MathJax-Span-2453" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2454" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2455"><span class="mrow" id="MathJax-Span-2456"><span class="mo" id="MathJax-Span-2457" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1002.15em, 4.255em, -999.997em); top: -3.327em; left: 50%; margin-left: -1.124em;"><span class="mrow" id="MathJax-Span-2458"><span class="mi" id="MathJax-Span-2459" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2460" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mn" id="MathJax-Span-2461" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2462"><span class="texatom" id="MathJax-Span-2463"><span class="mrow" id="MathJax-Span-2464"><span class="mo" id="MathJax-Span-2465" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2466" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-2467" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-2468" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-2469" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mo" id="MathJax-Span-2470" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2471" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2472"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2473" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2474"><span class="mrow" id="MathJax-Span-2475"><span class="texatom" id="MathJax-Span-2476"><span class="mrow" id="MathJax-Span-2477"><span class="mo" id="MathJax-Span-2478" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2479" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2480"><span class="mrow" id="MathJax-Span-2481"><span class="mo" id="MathJax-Span-2482" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2483" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="texatom" id="MathJax-Span-2484"><span class="mrow" id="MathJax-Span-2485"><span class="mo" id="MathJax-Span-2486" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2488"><span class="mrow" id="MathJax-Span-2489"><span class="mo" id="MathJax-Span-2490" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2491" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2492" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2493"><span class="texatom" id="MathJax-Span-2494"><span class="mrow" id="MathJax-Span-2495"><span class="mo" id="MathJax-Span-2496" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2497"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2498"><span class="texatom" id="MathJax-Span-2499"><span class="mrow" id="MathJax-Span-2500"><span class="mo" id="MathJax-Span-2501" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2502" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2503"><span class="mrow" id="MathJax-Span-2504"><span class="mo" id="MathJax-Span-2505" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1001.18em, 4.408em, -999.997em); top: -3.276em; left: 50%; margin-left: -0.663em;"><span class="mrow" id="MathJax-Span-2506"><span class="texatom" id="MathJax-Span-2507"><span class="mrow" id="MathJax-Span-2508"><span class="mo" id="MathJax-Span-2509" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2510" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2511"><span class="mrow" id="MathJax-Span-2512"><span class="mo" id="MathJax-Span-2513" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2514"><span class="texatom" id="MathJax-Span-2515"><span class="mrow" id="MathJax-Span-2516"><span class="mo" id="MathJax-Span-2517" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mi>k</mi><mo>+</mo><mn>2</mn></mrow></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>+</mo><mo>⋯</mo><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-173"> (-1)^{|Y|-k} \cdot \binom{|Y|}{k} + (-1)^{|Y|-k-1} \cdot \binom{|Y|}{k+1} + (-1)^{|Y|-k-2} \cdot \binom{|Y|}{k+2} + \cdots + (-1)^{|Y|-|Y|} \cdot \binom{|Y|}{|Y|} </script></p>

<p>Looking at Graham's (Graham, Knuth, Patashnik. "Concrete mathematics" [1998] ), we see a well-known formula for <a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">binomial coefficients</a>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2518" style="width: 18.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.218em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.693em, 1015.01em, 4.818em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2519"><span class="munderover" id="MathJax-Span-2520"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2521" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.23em, 4.255em, -999.997em); top: -2.866em; left: 0.105em;"><span class="texatom" id="MathJax-Span-2522"><span class="mrow" id="MathJax-Span-2523"><span class="mi" id="MathJax-Span-2524" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2525" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-2526" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.435em, 1000.62em, 4.152em, -999.997em); top: -5.12em; left: 0.412em;"><span class="mi" id="MathJax-Span-2527" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2528" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2529" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2530" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2531"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2532" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="mi" id="MathJax-Span-2533" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2534" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2535" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2536"><span class="texatom" id="MathJax-Span-2537"><span class="mrow" id="MathJax-Span-2538"><span class="mo" id="MathJax-Span-2539" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2540"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-2541" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-2542" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2543"><span class="texatom" id="MathJax-Span-2544"><span class="mrow" id="MathJax-Span-2545"><span class="mo" id="MathJax-Span-2546" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2547" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-2548" style="font-family: MathJax_Main; padding-left: 0.259em;">(</span><span class="mo" id="MathJax-Span-2549" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2550" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2551"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2552" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="mi" id="MathJax-Span-2553" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2554" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2555" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2556"><span class="texatom" id="MathJax-Span-2557"><span class="mrow" id="MathJax-Span-2558"><span class="mo" id="MathJax-Span-2559" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2560"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1002.21em, 4.255em, -999.997em); top: -4.659em; left: 50%; margin-left: -1.124em;"><span class="mrow" id="MathJax-Span-2561"><span class="mi" id="MathJax-Span-2562" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2563" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-2564" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.87em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.459em;"><span class="mi" id="MathJax-Span-2565" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2566"><span class="texatom" id="MathJax-Span-2567"><span class="mrow" id="MathJax-Span-2568"><span class="mo" id="MathJax-Span-2569" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>k</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>m</mi></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mi>m</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-174"> \sum_{k=0}^m (-1)^k \cdot \binom{n}{k} = (-1)^m \cdot \binom{n-1}{m} </script></p>

<p>Applying it here, we find that the entire sum of binomial coefficients is minimized:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2570" style="width: 11.222em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.173em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1008.97em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2571"><span class="mo" id="MathJax-Span-2572" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2573" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2574" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2575"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2576" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2577"><span class="mrow" id="MathJax-Span-2578"><span class="texatom" id="MathJax-Span-2579"><span class="mrow" id="MathJax-Span-2580"><span class="mo" id="MathJax-Span-2581" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2583"><span class="mrow" id="MathJax-Span-2584"><span class="mo" id="MathJax-Span-2585" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2586" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2587" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2588" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2589" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2590"><span class="texatom" id="MathJax-Span-2591"><span class="mrow" id="MathJax-Span-2592"><span class="mo" id="MathJax-Span-2593" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2594"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1002.92em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -1.483em;"><span class="mrow" id="MathJax-Span-2595"><span class="texatom" id="MathJax-Span-2596"><span class="mrow" id="MathJax-Span-2597"><span class="mo" id="MathJax-Span-2598" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2599" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2600"><span class="mrow" id="MathJax-Span-2601"><span class="mo" id="MathJax-Span-2602" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2603" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-2604" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1003.02em, 4.408em, -999.997em); top: -3.276em; left: 50%; margin-left: -1.534em;"><span class="mrow" id="MathJax-Span-2605"><span class="texatom" id="MathJax-Span-2606"><span class="mrow" id="MathJax-Span-2607"><span class="mo" id="MathJax-Span-2608" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2609" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2610"><span class="mrow" id="MathJax-Span-2611"><span class="mo" id="MathJax-Span-2612" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2613" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-2614" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2615"><span class="texatom" id="MathJax-Span-2616"><span class="mrow" id="MathJax-Span-2617"><span class="mo" id="MathJax-Span-2618" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mn>1</mn></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-175"> (-1)^{|Y|-k} \cdot \binom{|Y|-1}{|Y|-k} </script></p>

<p>Thus, for this task, we also obtained a solution with the asymptotics <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2619" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.59em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2620"><span class="mi" id="MathJax-Span-2621" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2622" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2623"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2624" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2625" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2626" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2627" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span><span class="mo" id="MathJax-Span-2628" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>k</mi></msup><mo>⋅</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-176">O(2^k \cdot k)</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2629" style="width: 21.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.779em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1017.68em, 5.023em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2630"><span class="mi" id="MathJax-Span-2631" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2632" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2633" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2634" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-2635" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.923em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0.771em;"><span class="mo" id="MathJax-Span-2636" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1002.92em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-2637"><span class="mrow" id="MathJax-Span-2638"><span class="mi" id="MathJax-Span-2639" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="mtext" id="MathJax-Span-2640" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-2641" style="font-size: 70.7%; font-family: MathJax_Main;">:</span><span class="mtext" id="MathJax-Span-2642" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="texatom" id="MathJax-Span-2643"><span class="mrow" id="MathJax-Span-2644"><span class="mo" id="MathJax-Span-2645" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2647"><span class="mrow" id="MathJax-Span-2648"><span class="mo" id="MathJax-Span-2649" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2650" style="font-size: 70.7%; font-family: MathJax_Main;">≥</span><span class="mi" id="MathJax-Span-2651" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2652" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2653" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2654" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2655"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2656" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2657"><span class="mrow" id="MathJax-Span-2658"><span class="texatom" id="MathJax-Span-2659"><span class="mrow" id="MathJax-Span-2660"><span class="mo" id="MathJax-Span-2661" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2662" style="font-size: 70.7%; font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.156em;"></span></span><span class="texatom" id="MathJax-Span-2663"><span class="mrow" id="MathJax-Span-2664"><span class="mo" id="MathJax-Span-2665" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2666" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-2667" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2668" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mrow" id="MathJax-Span-2669" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-2670"><span class="texatom" id="MathJax-Span-2671"><span class="mrow" id="MathJax-Span-2672"><span class="mo" id="MathJax-Span-2673" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2674"><span style="display: inline-block; position: relative; width: 3.025em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1002.92em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -1.483em;"><span class="mrow" id="MathJax-Span-2675"><span class="texatom" id="MathJax-Span-2676"><span class="mrow" id="MathJax-Span-2677"><span class="mo" id="MathJax-Span-2678" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2679" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2680"><span class="mrow" id="MathJax-Span-2681"><span class="mo" id="MathJax-Span-2682" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2683" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-2684" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1003.02em, 4.408em, -999.997em); top: -3.276em; left: 50%; margin-left: -1.534em;"><span class="mrow" id="MathJax-Span-2685"><span class="texatom" id="MathJax-Span-2686"><span class="mrow" id="MathJax-Span-2687"><span class="mo" id="MathJax-Span-2688" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2689" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="texatom" id="MathJax-Span-2690"><span class="mrow" id="MathJax-Span-2691"><span class="mo" id="MathJax-Span-2692" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2693" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-2694" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2695"><span class="texatom" id="MathJax-Span-2696"><span class="mrow" id="MathJax-Span-2697"><span class="mo" id="MathJax-Span-2698" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-2699" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2700" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2701" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2702" style="font-family: MathJax_Math-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.207em;"></span></span><span class="mo" id="MathJax-Span-2703" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.809em; border-left: 0px solid; width: 0px; height: 3.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>Y</mi><mtext>&nbsp;</mtext><mo>:</mo><mtext>&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>≥</mo><mi>k</mi></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></msup><mo>⋅</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mn>1</mn></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mi>k</mi></mrow></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-177"> ans = \sum_{Y ~ : ~ |Y| \ge k} (-1)^{|Y|-k} \cdot \binom{|Y|-1}{|Y|-k} \cdot f(Y) </script></p>

<h3 id="toc-tgt-14">The number of ways of going from a cell to another</h3>

<p>There is a field <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2704" style="width: 3.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.666em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.539em, 1002.67em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2705"><span class="mi" id="MathJax-Span-2706" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2707" style="font-family: MathJax_Main; padding-left: 0.207em;">×</span><span class="mi" id="MathJax-Span-2708" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">m</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>×</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">n \times m</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2709" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2710"><span class="mi" id="MathJax-Span-2711" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-179">k</script> of its cells are impassable walls. A robot is initially at the cell <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2712" style="width: 2.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.1em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2713"><span class="mo" id="MathJax-Span-2714" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-2715" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2716" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2717" style="font-family: MathJax_Main; padding-left: 0.156em;">1</span><span class="mo" id="MathJax-Span-2718" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-180">(1,1)</script> (bottom left). The robot can only move right or up, and eventually it needs to get into the cell <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2719" style="width: 3.332em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.718em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.62em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2720"><span class="mo" id="MathJax-Span-2721" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2722" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-2723" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-2724" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">m</span><span class="mo" id="MathJax-Span-2725" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-181">(n,m)</script>, avoiding all obstacles. You need to count the number of ways he can do it.</p>

<p>Assume that the sizes <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2726" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2727"><span class="mi" id="MathJax-Span-2728" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-182">n</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2729" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2730"><span class="mi" id="MathJax-Span-2731" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-183">m</script> are very large (say, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2732" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1001.44em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2733"><span class="msubsup" id="MathJax-Span-2734"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2735" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.027em;"><span class="mn" id="MathJax-Span-2736" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>9</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-184">10^9</script>), and the number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2737" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2738"><span class="mi" id="MathJax-Span-2739" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-185">k</script> is small (around <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2740" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.44em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2741"><span class="mn" id="MathJax-Span-2742" style="font-family: MathJax_Main;">100</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>100</mn></math></span></span><script type="math/tex" id="MathJax-Element-186">100</script>).</p>

<p>For now, sort the obstacles by their coordinate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2743" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2744"><span class="mi" id="MathJax-Span-2745" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">x</script>, and in case of equality — coordinate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2746" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2747"><span class="mi" id="MathJax-Span-2748" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-188">y</script>.</p>

<p>Also just learn how to solve a problem without obstacles: i.e. learn how to count the number of ways to get from one cell to another. In one axis, we need to go through <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2749" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2750"><span class="mi" id="MathJax-Span-2751" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-189">x</script> cells, and on the other, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2752" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2753"><span class="mi" id="MathJax-Span-2754" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-190">y</script> cells. From simple combinatorics, we get a formula using <a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">binomial coefficients</a>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2755" style="width: 4.562em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.742em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1003.54em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-2756"><span class="mrow" id="MathJax-Span-2757"><span class="TeXmathchoice" id="MathJax-Span-2758"><span class="texatom" id="MathJax-Span-2759"><span class="mrow" id="MathJax-Span-2760"><span class="mo" id="MathJax-Span-2761" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-2762"><span style="display: inline-block; position: relative; width: 2.257em; height: 0px;"><span style="position: absolute; clip: rect(3.281em, 1002.26em, 4.357em, -999.997em); top: -4.659em; left: 50%; margin-left: -1.124em;"><span class="mrow" id="MathJax-Span-2763"><span class="mi" id="MathJax-Span-2764" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-2765" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-2766" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-2767" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-2768"><span class="texatom" id="MathJax-Span-2769"><span class="mrow" id="MathJax-Span-2770"><span class="mo" id="MathJax-Span-2771" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mrow><mi>x</mi><mo>+</mo><mi>y</mi></mrow><mi>x</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-191">\binom{x+y}{x}</script></p>

<p>Now to count the number of ways to get from one cell to another, avoiding all obstacles, you can use inclusion-exclusion to solve the inverse problem: count the number of ways to walk through the board stepping at a subset of obstacles (and subtract it from the total number of ways).</p>

<p>When iterating over a subset of the obstacles that we'll step, to count the number of ways to do this simply multiply the number of all paths from starting cell to the first of the selected obstacles, a first obstacle to the second, and so on, and then add or subtract this number from the answer, in accordance with the standard formula of inclusion-exclusion.</p>

<p>However, this will again be non-polynomial in complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2772" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.59em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2773"><span class="mi" id="MathJax-Span-2774" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2775" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2776"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-2777" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.515em;"><span class="mi" id="MathJax-Span-2778" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2779" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2780" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">k</span><span class="mo" id="MathJax-Span-2781" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>k</mi></msup><mo>⋅</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-192">O(2^k \cdot k)</script>.</p>

<p>Here goes a polynomial solution:</p>

<p>We will use dynamic programming: let's compute the numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2782" style="width: 2.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.31em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2783"><span class="mi" id="MathJax-Span-2784" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2785" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2786" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2787" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2788" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2789" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2790" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-193">d[i][j]</script> — the number of ways to get from the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2791" style="width: 3.025em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.462em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.46em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2792"><span class="mi" id="MathJax-Span-2793" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2794" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-2795" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">t</span><span class="mi" id="MathJax-Span-2796" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>−</mo><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">i-th</script> point to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2797" style="width: 3.128em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.564em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.56em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2798"><span class="mi" id="MathJax-Span-2799" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2800" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-2801" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">t</span><span class="mi" id="MathJax-Span-2802" style="font-family: MathJax_Math-italic;">h</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>−</mo><mi>t</mi><mi>h</mi></math></span></span><script type="math/tex" id="MathJax-Element-195">j-th</script>, without stepping on any other obstacle (except for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2803" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2804"><span class="mi" id="MathJax-Span-2805" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-196">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2806" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2807"><span class="mi" id="MathJax-Span-2808" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-197">j</script>, of course). We will compute this number for all the obstacle cells, and also the starting and ending ones (all possible pairs of cells from these).</p>

<p>Let's forget for a second the obstacles and just count the number of paths from cell <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2809" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2810"><span class="mi" id="MathJax-Span-2811" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-198">i</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2812" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2813"><span class="mi" id="MathJax-Span-2814" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-199">j</script>. We need to consider some "bad" paths, the ones that pass through the obstacles, and subtract them from the total number of ways of going from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2815" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2816"><span class="mi" id="MathJax-Span-2817" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-200">i</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2818" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2819"><span class="mi" id="MathJax-Span-2820" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">j</script>.</p>

<p>When considering an obstacle <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2821" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2822"><span class="mi" id="MathJax-Span-2823" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-202">t</script> between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2824" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2825"><span class="mi" id="MathJax-Span-2826" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-203">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2827" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2828"><span class="mi" id="MathJax-Span-2829" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-204">j</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2830" style="width: 4.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.691em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1003.69em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2831"><span class="mi" id="MathJax-Span-2832" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2833" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-2834" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">t</span><span class="mo" id="MathJax-Span-2835" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-2836" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>&lt;</mo><mi>t</mi><mo>&lt;</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-205">i < t < j</script>), on which we can step, we see that the number of paths from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2837" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2838"><span class="mi" id="MathJax-Span-2839" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">i</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2840" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2841"><span class="mi" id="MathJax-Span-2842" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-207">j</script> that pass through <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2843" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2844"><span class="mi" id="MathJax-Span-2845" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-208">t</script> which have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2846" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2847"><span class="mi" id="MathJax-Span-2848" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-209">t</script> as the <strong>first obstacle between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2849" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2850"><span class="mi" id="MathJax-Span-2851" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-210">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2852" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2853"><span class="mi" id="MathJax-Span-2854" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-211">j</script></strong>. We can compute that as: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2855" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.26em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2856"><span class="mi" id="MathJax-Span-2857" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2858" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2859" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2860" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2861" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2862" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-2863" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-212">d[i][t]</script> multiplied by the number of arbitrary paths from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2864" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2865"><span class="mi" id="MathJax-Span-2866" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-213">t</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2867" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2868"><span class="mi" id="MathJax-Span-2869" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-214">j</script>. We can count the number of "bad" ways summing this for all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2870" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.437em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2871"><span class="mi" id="MathJax-Span-2872" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-215">t</script> between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2873" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2874"><span class="mi" id="MathJax-Span-2875" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-216">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2876" style="width: 0.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.41em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2877"><span class="mi" id="MathJax-Span-2878" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-217">j</script>.</p>

<p>We can compute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2879" style="width: 2.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.31em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2880"><span class="mi" id="MathJax-Span-2881" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2882" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2883" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2884" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2885" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2886" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2887" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-218">d[i][j]</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2888" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.95em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2889"><span class="mi" id="MathJax-Span-2890" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2891" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2892" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2893" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-219">O(k)</script> for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2894" style="width: 3.076em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.41em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2895"><span class="mi" id="MathJax-Span-2896" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2897" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2898"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2899" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mn" id="MathJax-Span-2900" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2901" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-220">O(k^2)</script> pairs, so this solution has complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2902" style="width: 3.076em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.513em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1002.41em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2903"><span class="mi" id="MathJax-Span-2904" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-2905" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-2906"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2907" style="font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mn" id="MathJax-Span-2908" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2909" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mn>3</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-221">O(k^3)</script>.</p>

<h3 id="toc-tgt-15">The number of coprime quadruples</h3>

<p>You're given <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2910" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2911"><span class="mi" id="MathJax-Span-2912" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-222">n</script> numbers: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2913" style="width: 6.816em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.587em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1005.59em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2914"><span class="msubsup" id="MathJax-Span-2915"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2916" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-2917" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2918" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-2919" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2920" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mn" id="MathJax-Span-2921" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2922" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-2923" style="font-family: MathJax_Main; padding-left: 0.156em;">…</span><span class="mo" id="MathJax-Span-2924" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-2925" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-2926" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-2927" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-223">a_1, a_2, \ldots, a_n</script>. You are required to count the number of ways to choose four numbers so that their combined greatest common divisor is equal to one.</p>

<p>We will solve the inverse problem — compute the number of "bad" quadruples, i.e. quadruples in which all numbers are divisible by a number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2928" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.26em, 2.41em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2929"><span class="mi" id="MathJax-Span-2930" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2931" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-2932" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-224">d > 1</script>.</p>

<p>We will use the inclusion-exclusion principle while summing over all possible groups of four numbers divisible by a divisor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2933" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2934"><span class="mi" id="MathJax-Span-2935" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-225">d</script>.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2936" style="width: 14.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.888em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.078em, 1011.78em, 3.64em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2937"><span class="mi" id="MathJax-Span-2938" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-2939" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-2940" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-2941" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="munderover" id="MathJax-Span-2942" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2943" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.23em, 4.357em, -999.997em); top: -2.866em; left: 0.105em;"><span class="texatom" id="MathJax-Span-2944"><span class="mrow" id="MathJax-Span-2945"><span class="mi" id="MathJax-Span-2946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2947" style="font-size: 70.7%; font-family: MathJax_Main;">≥</span><span class="mn" id="MathJax-Span-2948" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2949" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-2950" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2951" style="font-family: MathJax_Main;">1</span><span class="msubsup" id="MathJax-Span-2952"><span style="display: inline-block; position: relative; width: 3.332em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-2953" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 0.412em;"><span class="texatom" id="MathJax-Span-2954"><span class="mrow" id="MathJax-Span-2955"><span class="mi" id="MathJax-Span-2956" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2957" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-2958" style="font-size: 70.7%; font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2959" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2961" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2962" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2963" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-2964" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-2965" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2966" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2967" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2968" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>n</mi><mi>s</mi><mo>=</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mo>≥</mo><mn>2</mn></mrow></munder><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn></mrow></msup><mo>⋅</mo><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-226">ans = \sum_{d \ge 2} (-1)^{deg(d)-1} \cdot f(d)</script></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2969" style="width: 3.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.67em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2970"><span class="mi" id="MathJax-Span-2971" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-2972" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-2973" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2974" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2975" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2976" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-227">deg(d)</script> is the number of primes in the factorization of the number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2977" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2978"><span class="mi" id="MathJax-Span-2979" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-228">d</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2980" style="width: 2.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.74em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2981"><span class="mi" id="MathJax-Span-2982" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2983" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2984" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2985" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-229">f(d)</script> the number of quadruples divisible by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2986" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2987"><span class="mi" id="MathJax-Span-2988" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-230">d</script>.</p>

<p>To calculate the function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2989" style="width: 2.257em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.74em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2990"><span class="mi" id="MathJax-Span-2991" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-2992" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2993" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-2994" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-231">f(d)</script>, you just have to count the number of multiples of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2995" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2996"><span class="mi" id="MathJax-Span-2997" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-232">d</script> (as mentioned on a previous task) and use <a href="https://cp-algorithms.com/combinatorics/binomial-coefficients.html">binomial coefficients</a> to count the number of ways to choose four of them.</p>

<p>Thus, using the formula of inclusions-exclusions we sum the number of groups of four divisible by a prime number, then subtract the number of quadruples which are divisible by the product of two primes, add quadruples divisible by three primes, etc.</p>

<h3 id="toc-tgt-16">The number of harmonic triplets</h3>

<p>You are given a number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2998" style="width: 4.101em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.332em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1003.33em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2999"><span class="mi" id="MathJax-Span-3000" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3001" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="msubsup" id="MathJax-Span-3002" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.98em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mn" id="MathJax-Span-3003" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.403em; left: 1.027em;"><span class="mn" id="MathJax-Span-3004" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>6</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-233">n \le 10^6</script>. You are required to count the number of triples <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3005" style="width: 9.378em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.687em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1007.69em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3006"><span class="mn" id="MathJax-Span-3007" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3008" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="mi" id="MathJax-Span-3009" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">a</span><span class="mo" id="MathJax-Span-3010" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-3011" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">b</span><span class="mo" id="MathJax-Span-3012" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-3013" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">c</span><span class="mo" id="MathJax-Span-3014" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="mi" id="MathJax-Span-3015" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>≤</mo><mi>a</mi><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mi>c</mi><mo>≤</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-234">2 \le a < b < c \le n</script> that satisfy one of the following conditions:</p>

<ul>
<li>or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3016" style="width: 18.701em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.32em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1015.27em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3017"><span class="texatom" id="MathJax-Span-3018"><span class="mrow" id="MathJax-Span-3019"><span class="mi" id="MathJax-Span-3020" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3021" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3022" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3023" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3024" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3025" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3026" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">b</span><span class="mo" id="MathJax-Span-3027" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3028" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="texatom" id="MathJax-Span-3029" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-3030"><span class="mi" id="MathJax-Span-3031" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3032" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3033" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3034" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3035" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3036" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3037" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3038" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3039" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="texatom" id="MathJax-Span-3040" style="padding-left: 0.259em;"><span class="mrow" id="MathJax-Span-3041"><span class="mi" id="MathJax-Span-3042" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3043" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3044" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3045" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3046" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3047" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3048" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3049" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3050" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3051" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-235">{\rm gcd}(a,b) = {\rm gcd}(a,c) = {\rm gcd}(b,c) = 1</script>,</li>
<li>or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;c&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3052" style="width: 20.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.164em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1017.11em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3053"><span class="texatom" id="MathJax-Span-3054"><span class="mrow" id="MathJax-Span-3055"><span class="mi" id="MathJax-Span-3056" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3057" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3058" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3059" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3060" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3061" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3062" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">b</span><span class="mo" id="MathJax-Span-3063" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3064" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3065" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3066" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-3067" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-3068"><span class="mi" id="MathJax-Span-3069" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3070" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3071" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3072" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3073" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3074" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3075" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3076" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3077" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3078" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3079" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-3080" style="padding-left: 0.156em;"><span class="mrow" id="MathJax-Span-3081"><span class="mi" id="MathJax-Span-3082" style="font-family: MathJax_Main;">g</span><span class="mi" id="MathJax-Span-3083" style="font-family: MathJax_Main;">c</span><span class="mi" id="MathJax-Span-3084" style="font-family: MathJax_Main;">d</span></span></span><span class="mo" id="MathJax-Span-3085" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3086" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3087" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3088" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3089" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3090" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3091" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-236">{\rm gcd}(a,b) > 1, {\rm gcd}(a,c) > 1, {\rm gcd}(b,c) > 1</script>.</li>
</ul>

<p>First, go straight to the inverse problem — i.e. count the number of non-harmonic triples.</p>

<p>Second, note that any non-harmonic triplet is made of a pair of coprimes and a third number that is not coprime with at least one from the pair.</p>

<p>Thus, the number of non-harmonic triples that contain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3092" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3093"><span class="mi" id="MathJax-Span-3094" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-237">i</script> is equal the number of integers from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3095" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3096"><span class="mn" id="MathJax-Span-3097" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-238">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3098" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3099"><span class="mi" id="MathJax-Span-3100" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-239">n</script> that are coprimes with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3101" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3102"><span class="mi" id="MathJax-Span-3103" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-240">i</script> multiplied by the number of integers that are not coprime with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3104" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3105"><span class="mi" id="MathJax-Span-3106" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-241">i</script>.</p>

<p>Either <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3107" style="width: 22.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.24em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3108"><span class="mi" id="MathJax-Span-3109" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3110" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3111" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3112" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3113" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3114" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3115" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">b</span><span class="mo" id="MathJax-Span-3116" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3117" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3118" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3119" style="font-family: MathJax_Main; padding-left: 0.207em;">∧</span><span class="mi" id="MathJax-Span-3120" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3121" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3122" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3123" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3124" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3125" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3126" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3127" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3128" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3129" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3130" style="font-family: MathJax_Main; padding-left: 0.207em;">∧</span><span class="mi" id="MathJax-Span-3131" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3132" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3133" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3134" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3135" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3136" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3137" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3138" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3139" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3140" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>∧</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn><mo>∧</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-242">gcd(a,b) = 1 \wedge gcd(a,c) > 1 \wedge gcd(b,c) > 1</script></p>

<p>or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3141" style="width: 22.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.291em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.24em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3142"><span class="mi" id="MathJax-Span-3143" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3144" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3145" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3146" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3147" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3148" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3149" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">b</span><span class="mo" id="MathJax-Span-3150" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3151" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3152" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3153" style="font-family: MathJax_Main; padding-left: 0.207em;">∧</span><span class="mi" id="MathJax-Span-3154" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3155" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3156" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3157" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3158" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-3159" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3160" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3161" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3162" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3163" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span><span class="mo" id="MathJax-Span-3164" style="font-family: MathJax_Main; padding-left: 0.207em;">∧</span><span class="mi" id="MathJax-Span-3165" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3166" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3167" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3168" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3169" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-3170" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-3171" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">c</span><span class="mo" id="MathJax-Span-3172" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3173" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mn" id="MathJax-Span-3174" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>∧</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>∧</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-243">gcd(a,b) = 1 \wedge gcd(a,c) = 1 \wedge gcd(b,c) > 1</script></p>

<p>In both of these cases, it will be counted twice. The first case will be counted when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3175" style="width: 2.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.15em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3176"><span class="mi" id="MathJax-Span-3177" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3178" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-3179" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-244">i = a</script> and when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3180" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.05em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3181"><span class="mi" id="MathJax-Span-3182" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3183" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-3184" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-245">i = b</script>. The second case will be counted when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3185" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002.05em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3186"><span class="mi" id="MathJax-Span-3187" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3188" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-3189" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-246">i = b</script> and when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3190" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.05em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3191"><span class="mi" id="MathJax-Span-3192" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3193" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-3194" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-247">i = c</script>. Therefore, to compute the number of non-harmonic triples, we sum this calculation through all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3195" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3196"><span class="mi" id="MathJax-Span-3197" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-248">i</script> from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3198" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3199"><span class="mn" id="MathJax-Span-3200" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-249">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3201" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3202"><span class="mi" id="MathJax-Span-3203" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-250">n</script> and divide it by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3204" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3205"><span class="mn" id="MathJax-Span-3206" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-251">2</script>.</p>

<p>Now all we have left to solve is to learn to count the number of coprimes to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3207" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3208"><span class="mi" id="MathJax-Span-3209" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-252">i</script> in the interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3210" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3211"><span class="mo" id="MathJax-Span-3212" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-3213" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3214" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3215" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">n</span><span class="mo" id="MathJax-Span-3216" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>2</mn><mo>;</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-253">[2;n]</script>. Although this problem has already been mentioned, the above solution is not suitable here — it would require the factorization of each of the integers from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3217" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3218"><span class="mn" id="MathJax-Span-3219" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-254">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3220" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3221"><span class="mi" id="MathJax-Span-3222" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-255">n</script>, and then iterating through all subsets of these primes.</p>

<p>A faster solution is possible with such modification of the sieve of Eratosthenes:</p>

<ol>
<li><p>First, we find all numbers in the interval <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3223" style="width: 2.564em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.103em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3224"><span class="mo" id="MathJax-Span-3225" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-3226" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3227" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-3228" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">n</span><span class="mo" id="MathJax-Span-3229" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>2</mn><mo>;</mo><mi>n</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-256">[2;n]</script> such that its simple factorization does not include a prime factor twice. We will also need to know, for these numbers, how many factors it includes.</p>

<ul>
<li>To do this we will maintain an array <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3230" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.26em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3231"><span class="mi" id="MathJax-Span-3232" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3233" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3234" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3235" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3236" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3237" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-257">deg[i]</script> to store the number of primes in the factorization of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3238" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3239"><span class="mi" id="MathJax-Span-3240" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-258">i</script>, and an array <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3241" style="width: 3.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.77em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3242"><span class="mi" id="MathJax-Span-3243" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3244" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3245" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3246" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3247" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3248" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3249" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>o</mi><mi>o</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-259">good[i]</script>, to mark either if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3250" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3251"><span class="mi" id="MathJax-Span-3252" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-260">i</script> contains each factor at most twice (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3253" style="width: 5.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.664em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.61em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3254"><span class="mi" id="MathJax-Span-3255" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3256" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3257" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3258" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3259" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3260" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3261" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3262" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3263" style="font-family: MathJax_Main; padding-left: 0.259em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>o</mi><mi>o</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-261">good[i] = 1</script>) or not (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-262-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3264" style="width: 5.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.664em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.61em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3265"><span class="mi" id="MathJax-Span-3266" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3267" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3268" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3269" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3270" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3271" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3272" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3273" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mn" id="MathJax-Span-3274" style="font-family: MathJax_Main; padding-left: 0.259em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>o</mi><mi>o</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-262">good[i] = 0</script>). When iterating from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-263-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3275" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3276"><span class="mn" id="MathJax-Span-3277" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-263">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-264-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3278" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3279"><span class="mi" id="MathJax-Span-3280" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-264">n</script>, if we reach a number that has <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-265-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3281" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.49em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3282"><span class="mi" id="MathJax-Span-3283" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3284" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3285" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-265">deg</script> equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-266-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3286" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3287"><span class="mn" id="MathJax-Span-3288" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-266">0</script>, then it is a prime and its <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-267-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3289" style="width: 1.847em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.49em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3290"><span class="mi" id="MathJax-Span-3291" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3292" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3293" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-267">deg</script> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-268-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3294" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3295"><span class="mn" id="MathJax-Span-3296" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-268">1</script>.</li>
<li>During the sieve of Eratosthenes, we will iterate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-269-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3297" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3298"><span class="mi" id="MathJax-Span-3299" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-269">i</script> from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-270-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3300" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3301"><span class="mn" id="MathJax-Span-3302" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-270">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-271-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3303" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3304"><span class="mi" id="MathJax-Span-3305" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-271">n</script>. When processing a prime number we go through all of its multiples and increase their <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-272-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3306" style="width: 2.513em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.95em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3307"><span class="mi" id="MathJax-Span-3308" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3309" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3310" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3311" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-3312" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-272">deg[]</script>. If one of these multiples is multiple of the square of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-273-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3313" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3314"><span class="mi" id="MathJax-Span-3315" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-273">i</script>, then we can put <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-274-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3316" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1002em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3317"><span class="mi" id="MathJax-Span-3318" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3319" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3320" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3321" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>o</mi><mi>o</mi><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-274">good</script> as false.</li>
</ul></li>
<li><p>Second, we need to calculate the answer for all <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-275-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3322" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3323"><span class="mi" id="MathJax-Span-3324" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-275">i</script> from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-276-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3325" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3326"><span class="mn" id="MathJax-Span-3327" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-276">2</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-277-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3328" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3329"><span class="mi" id="MathJax-Span-3330" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-277">n</script>, i.e., the array <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-278-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3331" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3332"><span class="mi" id="MathJax-Span-3333" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3334" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-3335" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3336" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-3337" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-278">cnt[]</script> — the number of integers not coprime with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-279-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3338" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3339"><span class="mi" id="MathJax-Span-3340" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-279">i</script>.</p>

<ul>
<li>To do this, remember how the formula of inclusion-exclusion works — actually here we implement the same concept, but with inverted logic: we iterate over a component (a product of primes from the factorization) and add or subtract its term on the formula of inclusion-exclusion of each of its multiples.</li>
<li>So, let's say we are processing a number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-280-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3341" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3342"><span class="mi" id="MathJax-Span-3343" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-280">i</script> such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-281-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3344" style="width: 7.38em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.048em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1006em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3345"><span class="mi" id="MathJax-Span-3346" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3347" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3348" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-3349" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3350" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3351" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3352" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-3353" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-3354" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">t</span><span class="mi" id="MathJax-Span-3355" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-3356" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-3357" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mi>o</mi><mi>o</mi><mi>d</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-281">good[i] = true</script>, i.e., it is involved in the formula of inclusion-exclusion. Iterate through all numbers that are multiples of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-282-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3358" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3359"><span class="mi" id="MathJax-Span-3360" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-282">i</script>, and either add or subtract <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-283-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230A;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x230B;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3361" style="width: 3.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.666em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.51em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3362"><span class="mo" id="MathJax-Span-3363" style="font-family: MathJax_Main;">⌊</span><span class="mi" id="MathJax-Span-3364" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="texatom" id="MathJax-Span-3365"><span class="mrow" id="MathJax-Span-3366"><span class="mo" id="MathJax-Span-3367" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3368" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3369" style="font-family: MathJax_Main;">⌋</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">⌊</mo><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>i</mi><mo fence="false" stretchy="false">⌋</mo></math></span></span><script type="math/tex" id="MathJax-Element-283">\lfloor N/i \rfloor</script> from their <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-284-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3370" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3371"><span class="mi" id="MathJax-Span-3372" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-3373" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-3374" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-3375" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-3376" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>n</mi><mi>t</mi><mo stretchy="false">[</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-284">cnt[]</script> (the signal depends on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-285-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3377" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.26em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3378"><span class="mi" id="MathJax-Span-3379" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3380" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3381" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3382" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3383" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3384" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-285">deg[i]</script>: if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-286-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3385" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.359em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1002.26em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3386"><span class="mi" id="MathJax-Span-3387" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-3388" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-3389" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3390" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-3391" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-3392" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-286">deg[i]</script> is odd, then we must add, otherwise subtract).</li>
</ul></li>
</ol>

<p>Here's a C++ implementation:</p>

<pre><code class="cpp hljs"><span class="hljs-keyword">int</span> n;
<span class="hljs-keyword">bool</span> good[MAXN];
<span class="hljs-keyword">int</span> deg[MAXN], cnt[MAXN];

<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> solve() {
    <span class="hljs-built_in">memset</span> (good, <span class="hljs-number">1</span>, <span class="hljs-keyword">sizeof</span> good);
    <span class="hljs-built_in">memset</span> (deg, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> deg);
    <span class="hljs-built_in">memset</span> (cnt, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> cnt);

    <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ans_bad = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>; i&lt;=n; ++i) {
        <span class="hljs-keyword">if</span> (good[i]) {
            <span class="hljs-keyword">if</span> (deg[i] == <span class="hljs-number">0</span>)  deg[i] = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>; i*j&lt;=n; ++j) {
                <span class="hljs-keyword">if</span> (j &gt; <span class="hljs-number">1</span> &amp;&amp; deg[i] == <span class="hljs-number">1</span>)
                    <span class="hljs-keyword">if</span> (j % i == <span class="hljs-number">0</span>)
                        good[i*j] = <span class="hljs-keyword">false</span>;
                    <span class="hljs-keyword">else</span>
                        ++deg[i*j];
                cnt[i*j] += (n / i) * (deg[i]%<span class="hljs-number">2</span>==<span class="hljs-number">1</span> ? +<span class="hljs-number">1</span> : -<span class="hljs-number">1</span>);
            }
        }
        ans_bad += (cnt[i] - <span class="hljs-number">1</span>) * <span class="hljs-number">1l</span>l * (n-<span class="hljs-number">1</span> - cnt[i]);
    }

    <span class="hljs-keyword">return</span> (n-<span class="hljs-number">1</span>) * <span class="hljs-number">1l</span>l * (n-<span class="hljs-number">2</span>) * (n-<span class="hljs-number">3</span>) / <span class="hljs-number">6</span> - ans_bad / <span class="hljs-number">2</span>;
}
</code></pre>

<p>The asymptotics of our solution is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-287-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3393" style="width: 5.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.357em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.25em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3394"><span class="mi" id="MathJax-Span-3395" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-3396" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3397" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-3398" style="font-family: MathJax_Main; padding-left: 0.156em;">log</span><span class="mo" id="MathJax-Span-3399"></span><span class="mi" id="MathJax-Span-3400" style="font-family: MathJax_Math-italic; padding-left: 0.156em;">n</span><span class="mo" id="MathJax-Span-3401" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-287">O(n \log n)</script>, as for almost every number up to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-288-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3402" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3403"><span class="mi" id="MathJax-Span-3404" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-288">n</script> we make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-289-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3405" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.39em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3406"><span class="mi" id="MathJax-Span-3407" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-3408"><span class="mrow" id="MathJax-Span-3409"><span class="mo" id="MathJax-Span-3410" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-3411" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-289">n/i</script> iterations on the nested loop.</p>

<h3 id="toc-tgt-17">The number of permutations without fixed points (derangements)</h3>

<p>Prove that the number of permutations of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-290-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3412" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3413"><span class="mi" id="MathJax-Span-3414" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-290">n</script> without fixed points (i.e. no number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-291-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3415" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3416"><span class="mi" id="MathJax-Span-3417" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-291">i</script> is in position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-292-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3418" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3419"><span class="mi" id="MathJax-Span-3420" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-292">i</script> - also called a derangement) is equal to the following number:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-293-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3421" style="width: 39.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.636em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1032.53em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-3422"><span class="mi" id="MathJax-Span-3423" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3424" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3425" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-3426" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3427"><span class="texatom" id="MathJax-Span-3428"><span class="mrow" id="MathJax-Span-3429"><span class="mo" id="MathJax-Span-3430" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3431"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3432" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3433" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3434"><span class="texatom" id="MathJax-Span-3435"><span class="mrow" id="MathJax-Span-3436"><span class="mo" id="MathJax-Span-3437" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3438" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3439" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3440" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3441" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3442" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-3443" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3444" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3445" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mrow" id="MathJax-Span-3446" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3447"><span class="texatom" id="MathJax-Span-3448"><span class="mrow" id="MathJax-Span-3449"><span class="mo" id="MathJax-Span-3450" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3451"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3452" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3453" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3454"><span class="texatom" id="MathJax-Span-3455"><span class="mrow" id="MathJax-Span-3456"><span class="mo" id="MathJax-Span-3457" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3458" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3459" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3460" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3461" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3462" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-3463" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3464" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3465" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-3466" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3467"><span class="texatom" id="MathJax-Span-3468"><span class="mrow" id="MathJax-Span-3469"><span class="mo" id="MathJax-Span-3470" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3471"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3472" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3473" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3474"><span class="texatom" id="MathJax-Span-3475"><span class="mrow" id="MathJax-Span-3476"><span class="mo" id="MathJax-Span-3477" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3478" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3479" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3480" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3481" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3482" style="font-family: MathJax_Main; padding-left: 0.207em;">3</span><span class="mo" id="MathJax-Span-3483" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3484" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3485" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-3486" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-3487" style="font-family: MathJax_Main; padding-left: 0.207em;">±</span><span class="mrow" id="MathJax-Span-3488" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3489"><span class="texatom" id="MathJax-Span-3490"><span class="mrow" id="MathJax-Span-3491"><span class="mo" id="MathJax-Span-3492" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3493"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3494" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3495" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3496"><span class="texatom" id="MathJax-Span-3497"><span class="mrow" id="MathJax-Span-3498"><span class="mo" id="MathJax-Span-3499" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3500" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3501" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3502" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3503" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-3504" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">n</span><span class="mo" id="MathJax-Span-3505" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3506" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>n</mi><mo>!</mo><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mo>+</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>!</mo><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo>!</mo><mo>+</mo><mo>⋯</mo><mo>±</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo>!</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-293">n! - \binom{n}{1} \cdot (n-1)! + \binom{n}{2} \cdot (n-2)! - \binom{n}{3} \cdot (n-3)! + \cdots \pm \binom{n}{n} \cdot (n-n)! </script></p>

<p>and approximately equal to:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-294-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3507" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.669em, 1001.18em, 3.076em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3508"><span class="mfrac" id="MathJax-Span-3509"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.128em, 1000.82em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-3510"><span class="mi" id="MathJax-Span-3511" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3512" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-3513" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.98em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.976em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.934em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mi>e</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-294"> \frac{ n! }{ e } </script></p>

<p>(if you round this expression to the nearest whole number — you get exactly the number of permutations without fixed points)</p>

<p>Denote by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-295-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3514" style="width: 1.437em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.18em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3515"><span class="msubsup" id="MathJax-Span-3516"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3517" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-295">A_k</script> the set of permutations of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-296-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3519" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3520"><span class="mi" id="MathJax-Span-3521" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-296">n</script> with a fixed point at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-297-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3522" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3523"><span class="mi" id="MathJax-Span-3524" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-297">k</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-298-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3525" style="width: 5.126em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.203em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1004.2em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3526"><span class="mn" id="MathJax-Span-3527" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3528" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="mi" id="MathJax-Span-3529" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">k</span><span class="mo" id="MathJax-Span-3530" style="font-family: MathJax_Main; padding-left: 0.259em;">≤</span><span class="mi" id="MathJax-Span-3531" style="font-family: MathJax_Math-italic; padding-left: 0.259em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-298">1 \le k \le n</script>) (i.e. element <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-299-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3532" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3533"><span class="mi" id="MathJax-Span-3534" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-299">k</script> is at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-300-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3535" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3536"><span class="mi" id="MathJax-Span-3537" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-300">k</script>).</p>

<p>We now use the formula of inclusion-exclusion to count the number of permutations with at least one fixed point. For this we need to learn to count sizes of an intersection of sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-301-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3538" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1001.08em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3539"><span class="msubsup" id="MathJax-Span-3540"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3541" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-301">A_i</script>, as follows:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-302-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right center left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0 thickmathspace&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3543" style="width: 14.757em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.093em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(-0.766em, 1011.89em, 4.664em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3544"><span class="mtable" id="MathJax-Span-3545" style="padding-right: 0.156em; padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 11.785em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1006.46em, 8.558em, -999.997em); top: -6.094em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.611em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.64em, 4.46em, -999.997em); top: -6.043em; right: 0em;"><span class="mtd" id="MathJax-Span-3546"><span class="mrow" id="MathJax-Span-3547"><span class="mrow" id="MathJax-Span-3548"><span class="mo" id="MathJax-Span-3549" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="msubsup" id="MathJax-Span-3550"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3551" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3553" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1004.25em, 4.46em, -999.997em); top: -4.659em; right: 0em;"><span class="mtd" id="MathJax-Span-3569"><span class="mrow" id="MathJax-Span-3570"><span class="mtext" id="MathJax-Span-3571" style="font-family: MathJax_Main;">&nbsp;</span><span class="mrow" id="MathJax-Span-3572" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-3573" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mrow" id="MathJax-Span-3574"><span class="msubsup" id="MathJax-Span-3575"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3576" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3578" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-3579" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3580" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3581" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3582" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1006.46em, 4.46em, -999.997em); top: -3.225em; right: 0em;"><span class="mtd" id="MathJax-Span-3598"><span class="mrow" id="MathJax-Span-3599"><span class="mtext" id="MathJax-Span-3600" style="font-family: MathJax_Main;">&nbsp;</span><span class="mrow" id="MathJax-Span-3601" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-3602" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span><span class="mrow" id="MathJax-Span-3603"><span class="msubsup" id="MathJax-Span-3604"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3605" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3606" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3607" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-3608" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3609" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3610" style="font-size: 70.7%; font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3611" style="font-family: MathJax_Main; padding-left: 0.207em;">∩</span><span class="msubsup" id="MathJax-Span-3612" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3613" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="mi" id="MathJax-Span-3614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3615" style="vertical-align: 0em;"><span style="font-family: MathJax_Main;">|</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1001.95em, 4.357em, -999.997em); top: -1.842em; right: 0em;"><span class="mtd" id="MathJax-Span-3631"><span class="mrow" id="MathJax-Span-3632"><span class="mtext" id="MathJax-Span-3633" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-3634" style="font-family: MathJax_Main; padding-left: 0.156em;">⋯</span><span class="mo" id="MathJax-Span-3635" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.099em;"></span></span><span style="position: absolute; clip: rect(1.591em, 1000.98em, 5.074em, -999.997em); top: -4.147em; left: 6.611em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.486em, 1000.98em, 4.152em, -999.997em); top: -6.043em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-3554"><span class="mrow" id="MathJax-Span-3555"><span class="mi" id="MathJax-Span-3556"></span><span class="mo" id="MathJax-Span-3557" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.486em, 1000.98em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-3583"><span class="mrow" id="MathJax-Span-3584"><span class="mi" id="MathJax-Span-3585"></span><span class="mo" id="MathJax-Span-3586" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.486em, 1000.98em, 4.152em, -999.997em); top: -3.225em; left: 50%; margin-left: -0.51em;"><span class="mtd" id="MathJax-Span-3616"><span class="mrow" id="MathJax-Span-3617"><span class="mi" id="MathJax-Span-3618"></span><span class="mo" id="MathJax-Span-3619" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.152em;"></span></span><span style="position: absolute; clip: rect(1.847em, 1003.79em, 5.894em, -999.997em); top: -4.762em; left: 7.892em;"><span style="display: inline-block; position: relative; width: 3.896em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1003.79em, 4.408em, -999.997em); top: -6.043em; left: 0em;"><span class="mtd" id="MathJax-Span-3558"><span class="mrow" id="MathJax-Span-3559"><span class="mi" id="MathJax-Span-3560"></span><span class="mo" id="MathJax-Span-3561" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3562" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3563" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3564" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-3565" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3566" style="font-family: MathJax_Main;">!</span><span class="mtext" id="MathJax-Span-3567" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-3568" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1003.79em, 4.408em, -999.997em); top: -4.659em; left: 0em;"><span class="mtd" id="MathJax-Span-3587"><span class="mrow" id="MathJax-Span-3588"><span class="mi" id="MathJax-Span-3589"></span><span class="mo" id="MathJax-Span-3590" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3591" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3592" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3593" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-3594" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3595" style="font-family: MathJax_Main;">!</span><span class="mtext" id="MathJax-Span-3596" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-3597" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1003.79em, 4.408em, -999.997em); top: -3.225em; left: 0em;"><span class="mtd" id="MathJax-Span-3620"><span class="mrow" id="MathJax-Span-3621"><span class="mi" id="MathJax-Span-3622"></span><span class="mo" id="MathJax-Span-3623" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3624" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3625" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3626" style="font-family: MathJax_Main; padding-left: 0.207em;">3</span><span class="mo" id="MathJax-Span-3627" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3628" style="font-family: MathJax_Main;">!</span><span class="mtext" id="MathJax-Span-3629" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-3630" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.767em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.872em; border-left: 0px solid; width: 0px; height: 6.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right center left" rowspacing="3pt" columnspacing="0 thickmathspace" displaystyle="true"><mtr><mtd><mrow><mo>|</mo><msub><mi>A</mi><mi>p</mi></msub><mo>|</mo></mrow></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mtext>&nbsp;</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>&nbsp;</mtext><mrow><mo>|</mo><mrow><msub><mi>A</mi><mi>p</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>q</mi></msub></mrow><mo>|</mo></mrow></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>!</mo><mtext>&nbsp;</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>&nbsp;</mtext><mrow><mo>|</mo><mrow><msub><mi>A</mi><mi>p</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>q</mi></msub><mo>∩</mo><msub><mi>A</mi><mi>r</mi></msub></mrow><mo>|</mo></mrow></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo>!</mo><mtext>&nbsp;</mtext><mo>,</mo></mtd></mtr><mtr><mtd><mtext>&nbsp;</mtext><mo>⋯</mo><mo>,</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-302">\begin{eqnarray}
\left| A_p \right| &=& (n-1)!\ , \\\
\left| A_p \cap A_q \right| &=& (n-2)!\ , \\\
\left| A_p \cap A_q \cap A_r \right| &=& (n-3)!\ , \\\
\cdots ,
\end{eqnarray}</script></p>

<p>because if we know that the number of fixed points is equal <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-303-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3636" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3637"><span class="mi" id="MathJax-Span-3638" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-303">x</script>, then we know the position of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-304-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3639" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3640"><span class="mi" id="MathJax-Span-3641" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-304">x</script> elements of the permutation, and all other <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-305-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3642" style="width: 3.845em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.02em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3643"><span class="mo" id="MathJax-Span-3644" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3645" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3646" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-3647" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">x</span><span class="mo" id="MathJax-Span-3648" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-305">(n-x)</script> elements can be placed anywhere.</p>

<p>Substituting this into the formula of inclusion-exclusion, and given that the number of ways to choose a subset of size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-306-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3649" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3650"><span class="mi" id="MathJax-Span-3651" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-306">x</script> from the set of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-307-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3652" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3653"><span class="mi" id="MathJax-Span-3654" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-307">n</script> elements is equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-308-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3655" style="width: 1.642em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.18em, 2.82em, -999.997em); top: -2.303em; left: 0em;"><span class="mrow" id="MathJax-Span-3656"><span class="mrow" id="MathJax-Span-3657"><span class="TeXmathchoice" id="MathJax-Span-3658"><span class="texatom" id="MathJax-Span-3659"><span class="mrow" id="MathJax-Span-3660"><span class="mo" id="MathJax-Span-3661" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3662"><span style="display: inline-block; position: relative; width: 0.412em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.41em, 4.152em, -999.997em); top: -4.454em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-3663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.635em; left: 50%; margin-left: -0.202em;"><span class="mi" id="MathJax-Span-3664" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3665"><span class="texatom" id="MathJax-Span-3666"><span class="mrow" id="MathJax-Span-3667"><span class="mo" id="MathJax-Span-3668" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.308em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="1.2em" minsize="1.2em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>x</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="1.2em" minsize="1.2em">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-308">\binom{n}{x}</script>, we obtain a formula for the number of permutations with at least one fixed point:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-309-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3669" style="width: 37.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.535em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1030.43em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-3670"><span class="mrow" id="MathJax-Span-3671"><span class="TeXmathchoice" id="MathJax-Span-3672"><span class="texatom" id="MathJax-Span-3673"><span class="mrow" id="MathJax-Span-3674"><span class="mo" id="MathJax-Span-3675" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3676"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3677" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3678" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3679"><span class="texatom" id="MathJax-Span-3680"><span class="mrow" id="MathJax-Span-3681"><span class="mo" id="MathJax-Span-3682" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3683" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3684" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3685" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3686" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3687" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-3688" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3689" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3690" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-3691" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3692"><span class="texatom" id="MathJax-Span-3693"><span class="mrow" id="MathJax-Span-3694"><span class="mo" id="MathJax-Span-3695" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3696"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3697" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3698" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3699"><span class="texatom" id="MathJax-Span-3700"><span class="mrow" id="MathJax-Span-3701"><span class="mo" id="MathJax-Span-3702" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3703" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3704" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3705" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3706" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3707" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-3708" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3709" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3710" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mrow" id="MathJax-Span-3711" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3712"><span class="texatom" id="MathJax-Span-3713"><span class="mrow" id="MathJax-Span-3714"><span class="mo" id="MathJax-Span-3715" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3716"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3717" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3718" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3719"><span class="texatom" id="MathJax-Span-3720"><span class="mrow" id="MathJax-Span-3721"><span class="mo" id="MathJax-Span-3722" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3723" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3724" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3725" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3726" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3727" style="font-family: MathJax_Main; padding-left: 0.207em;">3</span><span class="mo" id="MathJax-Span-3728" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3729" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3730" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mo" id="MathJax-Span-3731" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-3732" style="font-family: MathJax_Main; padding-left: 0.207em;">±</span><span class="mrow" id="MathJax-Span-3733" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3734"><span class="texatom" id="MathJax-Span-3735"><span class="mrow" id="MathJax-Span-3736"><span class="mo" id="MathJax-Span-3737" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3738"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3739" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3740" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3741"><span class="texatom" id="MathJax-Span-3742"><span class="mrow" id="MathJax-Span-3743"><span class="mo" id="MathJax-Span-3744" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3745" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3746" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3747" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3748" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-3749" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">n</span><span class="mo" id="MathJax-Span-3750" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3751" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>!</mo><mo>+</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo>!</mo><mo>−</mo><mo>⋯</mo><mo>±</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo>!</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-309">\binom{n}{1} \cdot (n-1)! - \binom{n}{2} \cdot (n-2)! + \binom{n}{3} \cdot (n-3)! - \cdots \pm \binom{n}{n} \cdot (n-n)! </script></p>

<p>Then the number of permutations without fixed points is equal to:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-310-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;mfrac linethickness=&quot;0&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;2.047em&quot; minsize=&quot;2.047em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3752" style="width: 39.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.636em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1032.53em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-3753"><span class="mi" id="MathJax-Span-3754" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3755" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3756" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-3757" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3758"><span class="texatom" id="MathJax-Span-3759"><span class="mrow" id="MathJax-Span-3760"><span class="mo" id="MathJax-Span-3761" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3762"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3763" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3764" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3765"><span class="texatom" id="MathJax-Span-3766"><span class="mrow" id="MathJax-Span-3767"><span class="mo" id="MathJax-Span-3768" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3769" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3770" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3771" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3772" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3773" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span><span class="mo" id="MathJax-Span-3774" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3775" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3776" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mrow" id="MathJax-Span-3777" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3778"><span class="texatom" id="MathJax-Span-3779"><span class="mrow" id="MathJax-Span-3780"><span class="mo" id="MathJax-Span-3781" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3782"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3783" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3784" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3785"><span class="texatom" id="MathJax-Span-3786"><span class="mrow" id="MathJax-Span-3787"><span class="mo" id="MathJax-Span-3788" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3789" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3790" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3791" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3792" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3793" style="font-family: MathJax_Main; padding-left: 0.207em;">2</span><span class="mo" id="MathJax-Span-3794" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3795" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3796" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mrow" id="MathJax-Span-3797" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3798"><span class="texatom" id="MathJax-Span-3799"><span class="mrow" id="MathJax-Span-3800"><span class="mo" id="MathJax-Span-3801" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3802"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3803" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.46em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3804" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3805"><span class="texatom" id="MathJax-Span-3806"><span class="mrow" id="MathJax-Span-3807"><span class="mo" id="MathJax-Span-3808" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3809" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3810" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3811" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3812" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-3813" style="font-family: MathJax_Main; padding-left: 0.207em;">3</span><span class="mo" id="MathJax-Span-3814" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3815" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-3816" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-3817" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-3818" style="font-family: MathJax_Main; padding-left: 0.207em;">±</span><span class="mrow" id="MathJax-Span-3819" style="padding-left: 0.207em;"><span class="TeXmathchoice" id="MathJax-Span-3820"><span class="texatom" id="MathJax-Span-3821"><span class="mrow" id="MathJax-Span-3822"><span class="mo" id="MathJax-Span-3823" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span></span></span></span><span class="mfrac" id="MathJax-Span-3824"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3825" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-3826" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-3827"><span class="texatom" id="MathJax-Span-3828"><span class="mrow" id="MathJax-Span-3829"><span class="mo" id="MathJax-Span-3830" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span></span></span><span class="mo" id="MathJax-Span-3831" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mo" id="MathJax-Span-3832" style="font-family: MathJax_Main; padding-left: 0.207em;">(</span><span class="mi" id="MathJax-Span-3833" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3834" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-3835" style="font-family: MathJax_Math-italic; padding-left: 0.207em;">n</span><span class="mo" id="MathJax-Span-3836" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3837" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>n</mi><mo>!</mo><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>1</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mo>+</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>2</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>!</mo><mo>−</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mn>3</mn></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>3</mn><mo stretchy="false">)</mo><mo>!</mo><mo>+</mo><mo>⋯</mo><mo>±</mo><mrow><mrow class="MJX-TeXAtom-OPEN"><mo maxsize="2.047em" minsize="2.047em">(</mo></mrow><mfrac linethickness="0"><mi>n</mi><mi>n</mi></mfrac><mrow class="MJX-TeXAtom-CLOSE"><mo maxsize="2.047em" minsize="2.047em">)</mo></mrow></mrow><mo>⋅</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>n</mi><mo stretchy="false">)</mo><mo>!</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-310">n! - \binom{n}{1} \cdot (n-1)! + \binom{n}{2} \cdot (n-2)! - \binom{n}{3} \cdot (n-3)! + \cdots \pm \binom{n}{n} \cdot (n-n)! </script></p>

<p>Simplifying this expression, we obtain <strong>exact and approximate expressions for the number of permutations without fixed points</strong>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-311-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;&amp;#x00B1;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3838" style="width: 21.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.216em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.847em, 1017.22em, 4.562em, -999.997em); top: -3.43em; left: 0em;"><span class="mrow" id="MathJax-Span-3839"><span class="mi" id="MathJax-Span-3840" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3841" style="font-family: MathJax_Main;">!</span><span class="mrow" id="MathJax-Span-3842" style="padding-left: 0.156em;"><span class="mo" id="MathJax-Span-3843" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mrow" id="MathJax-Span-3844"><span class="mn" id="MathJax-Span-3845" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3846" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mfrac" id="MathJax-Span-3847" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3848" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.407em;"><span class="mrow" id="MathJax-Span-3849"><span class="mn" id="MathJax-Span-3850" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-3851" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.92em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.925em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-3852" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mfrac" id="MathJax-Span-3853" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3854" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.407em;"><span class="mrow" id="MathJax-Span-3855"><span class="mn" id="MathJax-Span-3856" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-3857" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.92em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.925em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-3858" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mfrac" id="MathJax-Span-3859" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3860" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.407em;"><span class="mrow" id="MathJax-Span-3861"><span class="mn" id="MathJax-Span-3862" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-3863" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.92em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.925em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="mo" id="MathJax-Span-3864" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mo" id="MathJax-Span-3865" style="font-family: MathJax_Main; padding-left: 0.207em;">⋯</span><span class="mo" id="MathJax-Span-3866" style="font-family: MathJax_Main; padding-left: 0.207em;">±</span><span class="mfrac" id="MathJax-Span-3867" style="padding-left: 0.207em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-3868" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1000.82em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-3869"><span class="mi" id="MathJax-Span-3870" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3871" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.98em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.976em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-3872" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span><span class="mo" id="MathJax-Span-3873" style="font-family: MathJax_Main; padding-left: 0.259em;">≈</span><span class="mfrac" id="MathJax-Span-3874" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.128em, 1000.82em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.459em;"><span class="mrow" id="MathJax-Span-3875"><span class="mi" id="MathJax-Span-3876" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3877" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.254em;"><span class="mi" id="MathJax-Span-3878" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.98em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.976em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.435em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>n</mi><mo>!</mo><mrow><mo>(</mo><mrow><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>!</mo></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mo>!</mo></mrow></mfrac><mo>−</mo><mfrac><mn>1</mn><mrow><mn>3</mn><mo>!</mo></mrow></mfrac><mo>+</mo><mo>⋯</mo><mo>±</mo><mfrac><mn>1</mn><mrow><mi>n</mi><mo>!</mo></mrow></mfrac></mrow><mo>)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mi>e</mi></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-311"> n! \left( 1 - \frac{1}{1!} + \frac{1}{2!} - \frac{1}{3!} + \cdots \pm \frac{1}{n!} \right ) \approx \frac{n!}{e} </script></p>

<p>(because the sum in brackets are the first <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-312-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3879" style="width: 2.82em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.308em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1002.26em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3880"><span class="mi" id="MathJax-Span-3881" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-3882" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mn" id="MathJax-Span-3883" style="font-family: MathJax_Main; padding-left: 0.207em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-312">n+1</script> terms of the expansion in Taylor series <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-313-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3884" style="width: 1.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1001.44em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3885"><span class="msubsup" id="MathJax-Span-3886"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3887" style="font-family: MathJax_Math-italic;">e</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="texatom" id="MathJax-Span-3888"><span class="mrow" id="MathJax-Span-3889"><span class="mo" id="MathJax-Span-3890" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-3891" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-313">e^{-1}</script>)</p>

<p>It is worth noting that a similar problem can be solved this way: when you need the fixed points were not among the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-314-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3892" style="width: 1.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.87em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3893"><span class="mi" id="MathJax-Span-3894" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-314">m</script> first elements of permutations (and not among all, as we just solved). The formula obtained is as the given above accurate formula, but it will go up to the sum of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-315-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3895" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.51em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3896"><span class="mi" id="MathJax-Span-3897" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-315">k</script>, instead of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-316-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3898" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3899"><span class="mi" id="MathJax-Span-3900" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-316">n</script>.</p>

<h2 id="toc-tgt-18">Practice Problems</h2>

<p>A list of tasks that can be solved using the principle of inclusions-exclusions:</p>

<ul>
<li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1266">UVA #10325 "The Lottery" [difficulty: low]</a></li>
<li><a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=2906">UVA #11806 "Cheerleaders" [difficulty: low]</a></li>
<li><a href="http://www.topcoder.com/stat?c=problem_statement&amp;pm=10875">TopCoder SRM 477 "CarelessSecretary" [difficulty: low]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=6658&amp;rd=10068">TopCoder TCHS 16 "Divisibility" [difficulty: low]</a></li>
<li><a href="http://www.spoj.com/problems/NGM2/">SPOJ #6285 NGM2 , "Another Game With Numbers" [difficulty: low]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=8470">TopCoder SRM 382 "CharmingTicketsEasy" [difficulty: medium]</a></li>
<li><a href="http://www.topcoder.com/stat?c=problem_statement&amp;pm=8307">TopCoder SRM 390 "SetOfPatterns" [difficulty: medium]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=2013">TopCoder SRM 176 "Deranged" [difficulty: medium]</a></li>
<li><a href="http://community.topcoder.com/stat?c=problem_statement&amp;pm=10702&amp;rd=14144&amp;rm=303184&amp;cr=22697599">TopCoder SRM 457 "TheHexagonsDivOne" [difficulty: medium]</a></li>
<li><a href="http://esci.ru/ttb/statement-62.htm">Test&gt;&gt;&gt;thebest "HarmonicTriples" (in Russian) [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/MSKYCODE/">SPOJ #4191 MSKYCODE "Sky Code" [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/SQFREE/">SPOJ #4168 SQFREE "Square-free integers" [difficulty: medium]</a></li>
<li><a href="http://www.codechef.com/JAN11/problems/COUNTREL/">CodeChef "Count Relations" [difficulty: medium]</a></li>
<li><a href="http://www.spoj.com/problems/KPRIMESB/">SPOJ - Almost Prime Numbers Again</a></li>
<li><a href="http://www.spoj.com/problems/IITKWPCH/">SPOJ - Find number of Pair of Friends</a></li>
<li><a href="http://www.spoj.com/problems/SUBSET/">SPOJ - Balanced Cow Subsets</a></li>
</ul>

    <div id="footer">
    (c) 2014-2019 translation by <a href="http://github.com/e-maxx-eng">http://github.com/e-maxx-eng</a>
    <span style="float: right; cursor: pointer;">10:0/0</span></div>
</div>

<script>
if (/e\-maxx\-eng|cp\-algorithms/.test(location.href)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85220282-1', 'auto');
  ga('send', 'pageview');
}
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>